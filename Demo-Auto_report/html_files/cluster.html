
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>

<head>
    <meta http-equiv="Content-Type"
          content="text/html; charset=utf-8" />
    <title></title>
    <style type="text/css">
        table.diff {font-family:Courier; border:medium;}
        .diff_header {background-color:#e0e0e0}
        td.diff_header {text-align:right}
        .diff_next {background-color:#c0c0c0}
        .diff_add {background-color:#aaffaa}
        .diff_chg {background-color:#ffff77}
        .diff_sub {background-color:#ffaaaa}
    </style>
</head>

<body>
    
    <table class="diff" id="difflib_chg_to2__top"
           cellspacing="0" cellpadding="0" rules="groups" >
        <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
        <colgroup></colgroup> <colgroup></colgroup> <colgroup></colgroup>
        
        <tbody>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__0">f</a></td><td class="diff_header" id="from2_1">1</td><td nowrap="nowrap">#include&nbsp;&lt;CL/sycl.hpp&gt;</td><td class="diff_next"><a href="#difflib_chg_to2__0">f</a></td><td class="diff_header" id="to2_1">1</td><td nowrap="nowrap">#include&nbsp;&lt;CL/sycl.hpp&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_2">2</td><td nowrap="nowrap">#include&nbsp;&lt;dpct/dpct.hpp&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_2">2</td><td nowrap="nowrap">#include&nbsp;&lt;dpct/dpct.hpp&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_3">3</td><td nowrap="nowrap">#include&nbsp;&lt;cmath&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_3">3</td><td nowrap="nowrap">#include&nbsp;&lt;cmath&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_4">4</td><td nowrap="nowrap">/*</td><td class="diff_next"></td><td class="diff_header" id="to2_4">4</td><td nowrap="nowrap">/*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_5">5</td><td nowrap="nowrap">&nbsp;*&nbsp;Inverts&nbsp;a&nbsp;square&nbsp;matrix&nbsp;(stored&nbsp;as&nbsp;a&nbsp;1D&nbsp;float&nbsp;array)</td><td class="diff_next"></td><td class="diff_header" id="to2_5">5</td><td nowrap="nowrap">&nbsp;*&nbsp;Inverts&nbsp;a&nbsp;square&nbsp;matrix&nbsp;(stored&nbsp;as&nbsp;a&nbsp;1D&nbsp;float&nbsp;array)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_6">6</td><td nowrap="nowrap">&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_6">6</td><td nowrap="nowrap">&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_7">7</td><td nowrap="nowrap">&nbsp;*&nbsp;actualsize&nbsp;-&nbsp;the&nbsp;dimension&nbsp;of&nbsp;the&nbsp;matrix</td><td class="diff_next"></td><td class="diff_header" id="to2_7">7</td><td nowrap="nowrap">&nbsp;*&nbsp;actualsize&nbsp;-&nbsp;the&nbsp;dimension&nbsp;of&nbsp;the&nbsp;matrix</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_8">8</td><td nowrap="nowrap">&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_8">8</td><td nowrap="nowrap">&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_9">9</td><td nowrap="nowrap">&nbsp;*&nbsp;written&nbsp;by&nbsp;Mike&nbsp;Dinolfo&nbsp;12/98</td><td class="diff_next"></td><td class="diff_header" id="to2_9">9</td><td nowrap="nowrap">&nbsp;*&nbsp;written&nbsp;by&nbsp;Mike&nbsp;Dinolfo&nbsp;12/98</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_10">10</td><td nowrap="nowrap">&nbsp;*&nbsp;version&nbsp;1.0</td><td class="diff_next"></td><td class="diff_header" id="to2_10">10</td><td nowrap="nowrap">&nbsp;*&nbsp;version&nbsp;1.0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_11">11</td><td nowrap="nowrap">&nbsp;*/</td><td class="diff_next"></td><td class="diff_header" id="to2_11">11</td><td nowrap="nowrap">&nbsp;*/</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_12">12</td><td nowrap="nowrap">void&nbsp;invert_cpu(float*&nbsp;data,&nbsp;int&nbsp;actualsize,&nbsp;float*&nbsp;log_determinant)&nbsp;&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_12">12</td><td nowrap="nowrap">void&nbsp;invert_cpu(float*&nbsp;data,&nbsp;int&nbsp;actualsize,&nbsp;float*&nbsp;log_determinant)&nbsp;&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_13">13</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;maxsize&nbsp;=&nbsp;actualsize;</td><td class="diff_next"></td><td class="diff_header" id="to2_13">13</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;maxsize&nbsp;=&nbsp;actualsize;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_14">14</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;n&nbsp;=&nbsp;actualsize;</td><td class="diff_next"></td><td class="diff_header" id="to2_14">14</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;n&nbsp;=&nbsp;actualsize;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;*log_determinant&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_15">15</td><td nowrap="nowrap">&nbsp;&nbsp;*log_determinant&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_16">16</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_16">16</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;if&nbsp;(actualsize&nbsp;==&nbsp;1)&nbsp;{&nbsp;//&nbsp;special&nbsp;case,&nbsp;dimensionality&nbsp;==&nbsp;1</td><td class="diff_next"></td><td class="diff_header" id="to2_17">17</td><td nowrap="nowrap">&nbsp;&nbsp;if&nbsp;(actualsize&nbsp;==&nbsp;1)&nbsp;{&nbsp;//&nbsp;special&nbsp;case,&nbsp;dimensionality&nbsp;==&nbsp;1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;*log_determinant&nbsp;=&nbsp;::logf(data[0]);</td><td class="diff_next"></td><td class="diff_header" id="to2_18">18</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;*log_determinant&nbsp;=&nbsp;::logf(data[0]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_19">19</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;data[0]&nbsp;=&nbsp;1.0&nbsp;/&nbsp;data[0];</td><td class="diff_next"></td><td class="diff_header" id="to2_19">19</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;data[0]&nbsp;=&nbsp;1.0&nbsp;/&nbsp;data[0];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_20">20</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;if(actualsize&nbsp;&gt;=&nbsp;2)&nbsp;{&nbsp;//&nbsp;dimensionality&nbsp;&gt;=&nbsp;2</td><td class="diff_next"></td><td class="diff_header" id="to2_20">20</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;if(actualsize&nbsp;&gt;=&nbsp;2)&nbsp;{&nbsp;//&nbsp;dimensionality&nbsp;&gt;=&nbsp;2</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_21">21</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=1;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++)&nbsp;data[i]&nbsp;/=&nbsp;data[0];&nbsp;//&nbsp;normalize&nbsp;row&nbsp;0</td><td class="diff_next"></td><td class="diff_header" id="to2_21">21</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=1;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++)&nbsp;data[i]&nbsp;/=&nbsp;data[0];&nbsp;//&nbsp;normalize&nbsp;row&nbsp;0</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_22">22</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=1;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++)&nbsp;&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_22">22</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;i=1;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++)&nbsp;&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_23">23</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;j=i;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++)&nbsp;&nbsp;{&nbsp;//&nbsp;do&nbsp;a&nbsp;column&nbsp;of&nbsp;L</td><td class="diff_next"></td><td class="diff_header" id="to2_23">23</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;j=i;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++)&nbsp;&nbsp;{&nbsp;//&nbsp;do&nbsp;a&nbsp;column&nbsp;of&nbsp;L</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;sum&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_24">24</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;sum&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_25">25</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;k&nbsp;=&nbsp;0;&nbsp;k&nbsp;&lt;&nbsp;i;&nbsp;k++)</td><td class="diff_next"></td><td class="diff_header" id="to2_25">25</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;k&nbsp;=&nbsp;0;&nbsp;k&nbsp;&lt;&nbsp;i;&nbsp;k++)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_26">26</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;+=&nbsp;data[j*maxsize+k]&nbsp;*&nbsp;data[k*maxsize+i];</td><td class="diff_next"></td><td class="diff_header" id="to2_26">26</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;+=&nbsp;data[j*maxsize+k]&nbsp;*&nbsp;data[k*maxsize+i];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[j*maxsize+i]&nbsp;-=&nbsp;sum;</td><td class="diff_next"></td><td class="diff_header" id="to2_27">27</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[j*maxsize+i]&nbsp;-=&nbsp;sum;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_28">28</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_28">28</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_29">29</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i&nbsp;==&nbsp;actualsize-1)&nbsp;continue;</td><td class="diff_next"></td><td class="diff_header" id="to2_29">29</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(i&nbsp;==&nbsp;actualsize-1)&nbsp;continue;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_30">30</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;j=i+1;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++)&nbsp;&nbsp;{&nbsp;&nbsp;//&nbsp;do&nbsp;a&nbsp;row&nbsp;of&nbsp;U</td><td class="diff_next"></td><td class="diff_header" id="to2_30">30</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;j=i+1;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++)&nbsp;&nbsp;{&nbsp;&nbsp;//&nbsp;do&nbsp;a&nbsp;row&nbsp;of&nbsp;U</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_31">31</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;sum&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_31">31</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;sum&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_32">32</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;k&nbsp;=&nbsp;0;&nbsp;k&nbsp;&lt;&nbsp;i;&nbsp;k++)</td><td class="diff_next"></td><td class="diff_header" id="to2_32">32</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;k&nbsp;=&nbsp;0;&nbsp;k&nbsp;&lt;&nbsp;i;&nbsp;k++)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_33">33</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;+=&nbsp;data[i*maxsize+k]*data[k*maxsize+j];</td><td class="diff_next"></td><td class="diff_header" id="to2_33">33</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;+=&nbsp;data[i*maxsize+k]*data[k*maxsize+j];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_34">34</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[i*maxsize+j]&nbsp;=</td><td class="diff_next"></td><td class="diff_header" id="to2_34">34</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[i*maxsize+j]&nbsp;=</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_35">35</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(data[i*maxsize+j]-sum)&nbsp;/&nbsp;data[i*maxsize+i];</td><td class="diff_next"></td><td class="diff_header" id="to2_35">35</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(data[i*maxsize+j]-sum)&nbsp;/&nbsp;data[i*maxsize+i];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_36">36</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_36">36</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_37">37</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_37">37</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_38">38</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_38">38</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_39">39</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;actualsize;&nbsp;i++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_39">39</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;actualsize;&nbsp;i++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_40">40</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*log_determinant&nbsp;+=&nbsp;::log10(fabs(data[i*n+i]));</td><td class="diff_next"></td><td class="diff_header" id="to2_40">40</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*log_determinant&nbsp;+=&nbsp;::log10(fabs(data[i*n+i]));</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_41">41</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//printf("log_determinant:&nbsp;%e\n",*log_determinant);</td><td class="diff_next"></td><td class="diff_header" id="to2_41">41</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//printf("log_determinant:&nbsp;%e\n",*log_determinant);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_42">42</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_42">42</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_43">43</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++&nbsp;)&nbsp;&nbsp;//&nbsp;invert&nbsp;L</td><td class="diff_next"></td><td class="diff_header" id="to2_43">43</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++&nbsp;)&nbsp;&nbsp;//&nbsp;invert&nbsp;L</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_44">44</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;j&nbsp;=&nbsp;i;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++&nbsp;)&nbsp;&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_44">44</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;j&nbsp;=&nbsp;i;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++&nbsp;)&nbsp;&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_45">45</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;x&nbsp;=&nbsp;1.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_45">45</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;x&nbsp;=&nbsp;1.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_46">46</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;i&nbsp;!=&nbsp;j&nbsp;)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_46">46</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;i&nbsp;!=&nbsp;j&nbsp;)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_47">47</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_47">47</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_48">48</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;k&nbsp;=&nbsp;i;&nbsp;k&nbsp;&lt;&nbsp;j;&nbsp;k++&nbsp;)</td><td class="diff_next"></td><td class="diff_header" id="to2_48">48</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;k&nbsp;=&nbsp;i;&nbsp;k&nbsp;&lt;&nbsp;j;&nbsp;k++&nbsp;)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_49">49</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;-=&nbsp;data[j*maxsize+k]*data[k*maxsize+i];</td><td class="diff_next"></td><td class="diff_header" id="to2_49">49</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;-=&nbsp;data[j*maxsize+k]*data[k*maxsize+i];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_50">50</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_50">50</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[j*maxsize+i]&nbsp;=&nbsp;x&nbsp;/&nbsp;data[j*maxsize+j];</td><td class="diff_next"></td><td class="diff_header" id="to2_51">51</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[j*maxsize+i]&nbsp;=&nbsp;x&nbsp;/&nbsp;data[j*maxsize+j];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_52">52</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_52">52</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_53">53</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++&nbsp;)&nbsp;&nbsp;&nbsp;//&nbsp;invert&nbsp;U</td><td class="diff_next"></td><td class="diff_header" id="to2_53">53</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++&nbsp;)&nbsp;&nbsp;&nbsp;//&nbsp;invert&nbsp;U</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_54">54</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;j&nbsp;=&nbsp;i;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++&nbsp;)&nbsp;&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_54">54</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;j&nbsp;=&nbsp;i;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++&nbsp;)&nbsp;&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_55">55</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;i&nbsp;==&nbsp;j&nbsp;)&nbsp;continue;</td><td class="diff_next"></td><td class="diff_header" id="to2_55">55</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(&nbsp;i&nbsp;==&nbsp;j&nbsp;)&nbsp;continue;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_56">56</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;sum&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_56">56</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;sum&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;k&nbsp;=&nbsp;i;&nbsp;k&nbsp;&lt;&nbsp;j;&nbsp;k++&nbsp;)</td><td class="diff_next"></td><td class="diff_header" id="to2_57">57</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;k&nbsp;=&nbsp;i;&nbsp;k&nbsp;&lt;&nbsp;j;&nbsp;k++&nbsp;)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_58">58</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;+=&nbsp;data[k*maxsize+j]*(&nbsp;(i==k)&nbsp;?&nbsp;1.0&nbsp;:&nbsp;data[i*maxsize+k]&nbsp;);</td><td class="diff_next"></td><td class="diff_header" id="to2_58">58</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;+=&nbsp;data[k*maxsize+j]*(&nbsp;(i==k)&nbsp;?&nbsp;1.0&nbsp;:&nbsp;data[i*maxsize+k]&nbsp;);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[i*maxsize+j]&nbsp;=&nbsp;-sum;</td><td class="diff_next"></td><td class="diff_header" id="to2_59">59</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[i*maxsize+j]&nbsp;=&nbsp;-sum;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_60">60</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_60">60</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_61">61</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++&nbsp;)&nbsp;&nbsp;&nbsp;//&nbsp;final&nbsp;inversion</td><td class="diff_next"></td><td class="diff_header" id="to2_61">61</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;actualsize;&nbsp;i++&nbsp;)&nbsp;&nbsp;&nbsp;//&nbsp;final&nbsp;inversion</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_62">62</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++&nbsp;)&nbsp;&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_62">62</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;actualsize;&nbsp;j++&nbsp;)&nbsp;&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_63">63</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;sum&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_63">63</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;sum&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_64">64</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;k&nbsp;=&nbsp;((i&gt;j)?i:j);&nbsp;k&nbsp;&lt;&nbsp;actualsize;&nbsp;k++&nbsp;)</td><td class="diff_next"></td><td class="diff_header" id="to2_64">64</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(&nbsp;int&nbsp;k&nbsp;=&nbsp;((i&gt;j)?i:j);&nbsp;k&nbsp;&lt;&nbsp;actualsize;&nbsp;k++&nbsp;)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_65">65</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;+=&nbsp;((j==k)?1.0:data[j*maxsize+k])*data[k*maxsize+i];</td><td class="diff_next"></td><td class="diff_header" id="to2_65">65</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum&nbsp;+=&nbsp;((j==k)?1.0:data[j*maxsize+k])*data[k*maxsize+i];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_66">66</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[j*maxsize+i]&nbsp;=&nbsp;sum;</td><td class="diff_next"></td><td class="diff_header" id="to2_66">66</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data[j*maxsize+i]&nbsp;=&nbsp;sum;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_67">67</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_67">67</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_68">68</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_68">68</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_69">69</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_69">69</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_70">70</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;PRINT("Error:&nbsp;Invalid&nbsp;dimensionality&nbsp;for&nbsp;invert(...)\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_70">70</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;PRINT("Error:&nbsp;Invalid&nbsp;dimensionality&nbsp;for&nbsp;invert(...)\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_71">71</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_71">71</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_72">72</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_72">72</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_73">73</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_73">73</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_74">74</td><td nowrap="nowrap">///////////////////////////////////////////////////////////////////////////////</td><td class="diff_next"></td><td class="diff_header" id="to2_74">74</td><td nowrap="nowrap">///////////////////////////////////////////////////////////////////////////////</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_75">75</td><td nowrap="nowrap">//&nbsp;Validate&nbsp;command&nbsp;line&nbsp;arguments</td><td class="diff_next"></td><td class="diff_header" id="to2_75">75</td><td nowrap="nowrap">//&nbsp;Validate&nbsp;command&nbsp;line&nbsp;arguments</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_76">76</td><td nowrap="nowrap">///////////////////////////////////////////////////////////////////////////////</td><td class="diff_next"></td><td class="diff_header" id="to2_76">76</td><td nowrap="nowrap">///////////////////////////////////////////////////////////////////////////////</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_77">77</td><td nowrap="nowrap">int&nbsp;validateArguments(int&nbsp;argc,&nbsp;char**&nbsp;argv,&nbsp;int*&nbsp;num_clusters,&nbsp;int*&nbsp;target_num_clusters)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_77">77</td><td nowrap="nowrap">int&nbsp;validateArguments(int&nbsp;argc,&nbsp;char**&nbsp;argv,&nbsp;int*&nbsp;num_clusters,&nbsp;int*&nbsp;target_num_clusters)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_78">78</td><td nowrap="nowrap">&nbsp;&nbsp;if(argc&nbsp;&lt;=&nbsp;5&nbsp;&amp;&amp;&nbsp;argc&nbsp;&gt;=&nbsp;4)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_78">78</td><td nowrap="nowrap">&nbsp;&nbsp;if(argc&nbsp;&lt;=&nbsp;5&nbsp;&amp;&amp;&nbsp;argc&nbsp;&gt;=&nbsp;4)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_79">79</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parse&nbsp;num_clusters</td><td class="diff_next"></td><td class="diff_header" id="to2_79">79</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parse&nbsp;num_clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_80">80</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(!sscanf(argv[1],"%d",num_clusters))&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_80">80</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(!sscanf(argv[1],"%d",num_clusters))&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_81">81</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid&nbsp;number&nbsp;of&nbsp;starting&nbsp;clusters\n\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_81">81</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid&nbsp;number&nbsp;of&nbsp;starting&nbsp;clusters\n\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_82">82</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td><td class="diff_next"></td><td class="diff_header" id="to2_82">82</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_83">83</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;</td><td class="diff_next"></td><td class="diff_header" id="to2_83">83</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_84">84</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_84">84</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_85">85</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_85">85</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_86">86</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Check&nbsp;bounds&nbsp;for&nbsp;num_clusters</td><td class="diff_next"></td><td class="diff_header" id="to2_86">86</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Check&nbsp;bounds&nbsp;for&nbsp;num_clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_87">87</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(*num_clusters&nbsp;&lt;&nbsp;1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_87">87</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(*num_clusters&nbsp;&lt;&nbsp;1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_88">88</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid&nbsp;number&nbsp;of&nbsp;starting&nbsp;clusters\n\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_88">88</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid&nbsp;number&nbsp;of&nbsp;starting&nbsp;clusters\n\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_89">89</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td><td class="diff_next"></td><td class="diff_header" id="to2_89">89</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_90">90</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;</td><td class="diff_next"></td><td class="diff_header" id="to2_90">90</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_91">91</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_91">91</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_92">92</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_92">92</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_93">93</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parse&nbsp;infile</td><td class="diff_next"></td><td class="diff_header" id="to2_93">93</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parse&nbsp;infile</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_94">94</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;FILE*&nbsp;infile&nbsp;=&nbsp;fopen(argv[2],"r");</td><td class="diff_next"></td><td class="diff_header" id="to2_94">94</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;FILE*&nbsp;infile&nbsp;=&nbsp;fopen(argv[2],"r");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_95">95</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(!infile)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_95">95</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(!infile)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_96">96</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid&nbsp;infile.\n\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_96">96</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid&nbsp;infile.\n\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_97">97</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td><td class="diff_next"></td><td class="diff_header" id="to2_97">97</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_98">98</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;2;</td><td class="diff_next"></td><td class="diff_header" id="to2_98">98</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;2;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_99">99</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_99">99</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_100">100</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_100">100</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_101">101</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parse&nbsp;target_num_clusters</td><td class="diff_next"></td><td class="diff_header" id="to2_101">101</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parse&nbsp;target_num_clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_102">102</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(argc&nbsp;==&nbsp;5)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_102">102</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(argc&nbsp;==&nbsp;5)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_103">103</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!sscanf(argv[4],"%d",target_num_clusters))&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_103">103</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(!sscanf(argv[4],"%d",target_num_clusters))&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_104">104</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid&nbsp;number&nbsp;of&nbsp;desired&nbsp;clusters.\n\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_104">104</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Invalid&nbsp;number&nbsp;of&nbsp;desired&nbsp;clusters.\n\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_105">105</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td><td class="diff_next"></td><td class="diff_header" id="to2_105">105</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_106">106</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;4;</td><td class="diff_next"></td><td class="diff_header" id="to2_106">106</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;4;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_107">107</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_107">107</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_108">108</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(*target_num_clusters&nbsp;&gt;&nbsp;*num_clusters)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_108">108</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(*target_num_clusters&nbsp;&gt;&nbsp;*num_clusters)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_109">109</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("target_num_clusters&nbsp;must&nbsp;be&nbsp;less&nbsp;than&nbsp;equal&nbsp;to&nbsp;num_clusters\n\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_109">109</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("target_num_clusters&nbsp;must&nbsp;be&nbsp;less&nbsp;than&nbsp;equal&nbsp;to&nbsp;num_clusters\n\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_110">110</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td><td class="diff_next"></td><td class="diff_header" id="to2_110">110</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_111">111</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;4;</td><td class="diff_next"></td><td class="diff_header" id="to2_111">111</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;4;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_112">112</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_112">112</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_113">113</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_113">113</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_114">114</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*target_num_clusters&nbsp;=&nbsp;0;</td><td class="diff_next"></td><td class="diff_header" id="to2_114">114</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*target_num_clusters&nbsp;=&nbsp;0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_115">115</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_115">115</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_116">116</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_116">116</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_117">117</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Clean&nbsp;up&nbsp;so&nbsp;the&nbsp;EPA&nbsp;is&nbsp;happy</td><td class="diff_next"></td><td class="diff_header" id="to2_117">117</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Clean&nbsp;up&nbsp;so&nbsp;the&nbsp;EPA&nbsp;is&nbsp;happy</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_118">118</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fclose(infile);</td><td class="diff_next"></td><td class="diff_header" id="to2_118">118</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fclose(infile);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_119">119</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;</td><td class="diff_next"></td><td class="diff_header" id="to2_119">119</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_120">120</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_120">120</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_121">121</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td><td class="diff_next"></td><td class="diff_header" id="to2_121">121</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;printUsage(argv);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_122">122</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;</td><td class="diff_next"></td><td class="diff_header" id="to2_122">122</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;1;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_123">123</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_123">123</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_124">124</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_124">124</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_125">125</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_125">125</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_126">126</td><td nowrap="nowrap">///////////////////////////////////////////////////////////////////////////////</td><td class="diff_next"></td><td class="diff_header" id="to2_126">126</td><td nowrap="nowrap">///////////////////////////////////////////////////////////////////////////////</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_127">127</td><td nowrap="nowrap">//&nbsp;Print&nbsp;usage&nbsp;statement</td><td class="diff_next"></td><td class="diff_header" id="to2_127">127</td><td nowrap="nowrap">//&nbsp;Print&nbsp;usage&nbsp;statement</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_128">128</td><td nowrap="nowrap">///////////////////////////////////////////////////////////////////////////////</td><td class="diff_next"></td><td class="diff_header" id="to2_128">128</td><td nowrap="nowrap">///////////////////////////////////////////////////////////////////////////////</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_129">129</td><td nowrap="nowrap">void&nbsp;printUsage(char**&nbsp;argv)</td><td class="diff_next"></td><td class="diff_header" id="to2_129">129</td><td nowrap="nowrap">void&nbsp;printUsage(char**&nbsp;argv)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_130">130</td><td nowrap="nowrap">{</td><td class="diff_next"></td><td class="diff_header" id="to2_130">130</td><td nowrap="nowrap">{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_131">131</td><td nowrap="nowrap">&nbsp;&nbsp;printf("Usage:&nbsp;%s&nbsp;num_clusters&nbsp;infile&nbsp;outfile&nbsp;[target_num_clusters]\n",argv[0]);</td><td class="diff_next"></td><td class="diff_header" id="to2_131">131</td><td nowrap="nowrap">&nbsp;&nbsp;printf("Usage:&nbsp;%s&nbsp;num_clusters&nbsp;infile&nbsp;outfile&nbsp;[target_num_clusters]\n",argv[0]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_132">132</td><td nowrap="nowrap">&nbsp;&nbsp;printf("\t&nbsp;num_clusters:&nbsp;The&nbsp;number&nbsp;of&nbsp;starting&nbsp;clusters\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_132">132</td><td nowrap="nowrap">&nbsp;&nbsp;printf("\t&nbsp;num_clusters:&nbsp;The&nbsp;number&nbsp;of&nbsp;starting&nbsp;clusters\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_133">133</td><td nowrap="nowrap">&nbsp;&nbsp;printf("\t&nbsp;infile:&nbsp;ASCII&nbsp;space-delimited&nbsp;FCS&nbsp;data&nbsp;file\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_133">133</td><td nowrap="nowrap">&nbsp;&nbsp;printf("\t&nbsp;infile:&nbsp;ASCII&nbsp;space-delimited&nbsp;FCS&nbsp;data&nbsp;file\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_134">134</td><td nowrap="nowrap">&nbsp;&nbsp;printf("\t&nbsp;outfile:&nbsp;Clustering&nbsp;results&nbsp;output&nbsp;file\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_134">134</td><td nowrap="nowrap">&nbsp;&nbsp;printf("\t&nbsp;outfile:&nbsp;Clustering&nbsp;results&nbsp;output&nbsp;file\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_135">135</td><td nowrap="nowrap">&nbsp;&nbsp;printf("\t&nbsp;target_num_clusters:&nbsp;A&nbsp;desired&nbsp;number&nbsp;of&nbsp;clusters.&nbsp;Must&nbsp;be&nbsp;less&nbsp;than&nbsp;or&nbsp;equal&nbsp;to&nbsp;num_clusters\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_135">135</td><td nowrap="nowrap">&nbsp;&nbsp;printf("\t&nbsp;target_num_clusters:&nbsp;A&nbsp;desired&nbsp;number&nbsp;of&nbsp;clusters.&nbsp;Must&nbsp;be&nbsp;less&nbsp;than&nbsp;or&nbsp;equal&nbsp;to&nbsp;num_clusters\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_136">136</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_136">136</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_137">137</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_137">137</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_138">138</td><td nowrap="nowrap">void&nbsp;writeCluster(FILE*&nbsp;f,&nbsp;clusters_t&nbsp;&amp;clusters,&nbsp;const&nbsp;int&nbsp;c,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_138">138</td><td nowrap="nowrap">void&nbsp;writeCluster(FILE*&nbsp;f,&nbsp;clusters_t&nbsp;&amp;clusters,&nbsp;const&nbsp;int&nbsp;c,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_139">139</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"Probability:&nbsp;%f\n",&nbsp;clusters.pi[c]);</td><td class="diff_next"></td><td class="diff_header" id="to2_139">139</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"Probability:&nbsp;%f\n",&nbsp;clusters.pi[c]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_140">140</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"N:&nbsp;%f\n",clusters.N[c]);</td><td class="diff_next"></td><td class="diff_header" id="to2_140">140</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"N:&nbsp;%f\n",clusters.N[c]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_141">141</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"Means:&nbsp;");</td><td class="diff_next"></td><td class="diff_header" id="to2_141">141</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"Means:&nbsp;");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_142">142</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;num_dimensions;&nbsp;i++){</td><td class="diff_next"></td><td class="diff_header" id="to2_142">142</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;num_dimensions;&nbsp;i++){</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_143">143</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fprintf(f,"%f&nbsp;",clusters.means[c*num_dimensions+i]);</td><td class="diff_next"></td><td class="diff_header" id="to2_143">143</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fprintf(f,"%f&nbsp;",clusters.means[c*num_dimensions+i]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_144">144</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_144">144</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_145">145</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_145">145</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_146">146</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_146">146</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_147">147</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"\nR&nbsp;Matrix:\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_147">147</td><td nowrap="nowrap">&nbsp;&nbsp;fprintf(f,"\nR&nbsp;Matrix:\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_148">148</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;num_dimensions;&nbsp;i++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_148">148</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;num_dimensions;&nbsp;i++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_149">149</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=0;&nbsp;j&lt;num_dimensions;&nbsp;j++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_149">149</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=0;&nbsp;j&lt;num_dimensions;&nbsp;j++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_150">150</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(f,"%f&nbsp;",&nbsp;clusters.R[c*num_dimensions*num_dimensions+i*num_dimensions+j]);</td><td class="diff_next"></td><td class="diff_header" id="to2_150">150</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fprintf(f,"%f&nbsp;",&nbsp;clusters.R[c*num_dimensions*num_dimensions+i*num_dimensions+j]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_151">151</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_151">151</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_152">152</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fprintf(f,"\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_152">152</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fprintf(f,"\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_153">153</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_153">153</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_154">154</td><td nowrap="nowrap">&nbsp;&nbsp;fflush(f);&nbsp;&nbsp;&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_154">154</td><td nowrap="nowrap">&nbsp;&nbsp;fflush(f);&nbsp;&nbsp;&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_155">155</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_155">155</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_156">156</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_156">156</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_157">157</td><td nowrap="nowrap">/*</td><td class="diff_next"></td><td class="diff_header" id="to2_157">157</td><td nowrap="nowrap">/*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_158">158</td><td nowrap="nowrap">&nbsp;*&nbsp;Seeds&nbsp;the&nbsp;cluster&nbsp;centers&nbsp;(means)&nbsp;with&nbsp;random&nbsp;data&nbsp;points</td><td class="diff_next"></td><td class="diff_header" id="to2_158">158</td><td nowrap="nowrap">&nbsp;*&nbsp;Seeds&nbsp;the&nbsp;cluster&nbsp;centers&nbsp;(means)&nbsp;with&nbsp;random&nbsp;data&nbsp;points</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_159">159</td><td nowrap="nowrap">&nbsp;*/</td><td class="diff_next"></td><td class="diff_header" id="to2_159">159</td><td nowrap="nowrap">&nbsp;*/</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_160">160</td><td nowrap="nowrap">void&nbsp;seed_clusters(clusters_t*&nbsp;clusters,&nbsp;float*&nbsp;fcs_data,&nbsp;int&nbsp;num_clusters,&nbsp;int&nbsp;num_dimensions,&nbsp;int&nbsp;num_events)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_160">160</td><td nowrap="nowrap">void&nbsp;seed_clusters(clusters_t*&nbsp;clusters,&nbsp;float*&nbsp;fcs_data,&nbsp;int&nbsp;num_clusters,&nbsp;int&nbsp;num_dimensions,&nbsp;int&nbsp;num_events)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_161">161</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;fraction;</td><td class="diff_next"></td><td class="diff_header" id="to2_161">161</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;fraction;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_162">162</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;seed;</td><td class="diff_next"></td><td class="diff_header" id="to2_162">162</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;seed;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_163">163</td><td nowrap="nowrap">&nbsp;&nbsp;if(num_clusters&nbsp;&gt;&nbsp;1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_163">163</td><td nowrap="nowrap">&nbsp;&nbsp;if(num_clusters&nbsp;&gt;&nbsp;1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_164">164</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;=&nbsp;(num_events-1.0f)/(num_clusters-1.0f);</td><td class="diff_next"></td><td class="diff_header" id="to2_164">164</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;=&nbsp;(num_events-1.0f)/(num_clusters-1.0f);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_165">165</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_165">165</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_166">166</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_166">166</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;fraction&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_167">167</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_167">167</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_168">168</td><td nowrap="nowrap">&nbsp;&nbsp;srand((unsigned&nbsp;int)&nbsp;time(NULL));</td><td class="diff_next"></td><td class="diff_header" id="to2_168">168</td><td nowrap="nowrap">&nbsp;&nbsp;srand((unsigned&nbsp;int)&nbsp;time(NULL));</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_169">169</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Sets&nbsp;the&nbsp;means&nbsp;from&nbsp;evenly&nbsp;distributed&nbsp;points&nbsp;in&nbsp;the&nbsp;input&nbsp;data</td><td class="diff_next"></td><td class="diff_header" id="to2_169">169</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Sets&nbsp;the&nbsp;means&nbsp;from&nbsp;evenly&nbsp;distributed&nbsp;points&nbsp;in&nbsp;the&nbsp;input&nbsp;data</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_170">170</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;num_clusters;&nbsp;c++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_170">170</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;num_clusters;&nbsp;c++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_171">171</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;clusters-&gt;N[c]&nbsp;=&nbsp;(float)num_events/(float)num_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_171">171</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;clusters-&gt;N[c]&nbsp;=&nbsp;(float)num_events/(float)num_clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_172">172</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)</td><td class="diff_next"></td><td class="diff_header" id="to2_172">172</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_173">173</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters-&gt;means[c*num_dimensions+d]&nbsp;=&nbsp;fcs_data[((int)(c*fraction))*num_dimensions+d];</td><td class="diff_next"></td><td class="diff_header" id="to2_173">173</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters-&gt;means[c*num_dimensions+d]&nbsp;=&nbsp;fcs_data[((int)(c*fraction))*num_dimensions+d];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_174">174</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_174">174</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_175">175</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_175">175</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_176">176</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_176">176</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_177">177</td><td nowrap="nowrap">void&nbsp;add_clusters(clusters_t&nbsp;&amp;clusters,&nbsp;const&nbsp;int&nbsp;c1,&nbsp;const&nbsp;int&nbsp;c2,&nbsp;clusters_t&nbsp;&amp;temp_cluster,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_177">177</td><td nowrap="nowrap">void&nbsp;add_clusters(clusters_t&nbsp;&amp;clusters,&nbsp;const&nbsp;int&nbsp;c1,&nbsp;const&nbsp;int&nbsp;c2,&nbsp;clusters_t&nbsp;&amp;temp_cluster,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_178">178</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;wt1,wt2;</td><td class="diff_next"></td><td class="diff_header" id="to2_178">178</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;wt1,wt2;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_179">179</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_179">179</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_180">180</td><td nowrap="nowrap">&nbsp;&nbsp;wt1&nbsp;=&nbsp;(clusters.N[c1])&nbsp;/&nbsp;(clusters.N[c1]&nbsp;+&nbsp;clusters.N[c2]);</td><td class="diff_next"></td><td class="diff_header" id="to2_180">180</td><td nowrap="nowrap">&nbsp;&nbsp;wt1&nbsp;=&nbsp;(clusters.N[c1])&nbsp;/&nbsp;(clusters.N[c1]&nbsp;+&nbsp;clusters.N[c2]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_181">181</td><td nowrap="nowrap">&nbsp;&nbsp;wt2&nbsp;=&nbsp;1.0f&nbsp;-&nbsp;wt1;</td><td class="diff_next"></td><td class="diff_header" id="to2_181">181</td><td nowrap="nowrap">&nbsp;&nbsp;wt2&nbsp;=&nbsp;1.0f&nbsp;-&nbsp;wt1;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_182">182</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_182">182</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_183">183</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Compute&nbsp;new&nbsp;weighted&nbsp;means</td><td class="diff_next"></td><td class="diff_header" id="to2_183">183</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Compute&nbsp;new&nbsp;weighted&nbsp;means</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_184">184</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;num_dimensions;i++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_184">184</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;num_dimensions;i++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_185">185</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;temp_cluster.means[i]&nbsp;=&nbsp;wt1*clusters.means[c1*num_dimensions+i]&nbsp;+&nbsp;wt2*clusters.means[c2*num_dimensions+i];</td><td class="diff_next"></td><td class="diff_header" id="to2_185">185</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;temp_cluster.means[i]&nbsp;=&nbsp;wt1*clusters.means[c1*num_dimensions+i]&nbsp;+&nbsp;wt2*clusters.means[c2*num_dimensions+i];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_186">186</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_186">186</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_187">187</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_187">187</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_188">188</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Compute&nbsp;new&nbsp;weighted&nbsp;covariance</td><td class="diff_next"></td><td class="diff_header" id="to2_188">188</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Compute&nbsp;new&nbsp;weighted&nbsp;covariance</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_189">189</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;num_dimensions;&nbsp;i++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_189">189</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&lt;num_dimensions;&nbsp;i++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_190">190</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=i;&nbsp;j&lt;num_dimensions;&nbsp;j++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_190">190</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=i;&nbsp;j&lt;num_dimensions;&nbsp;j++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_191">191</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Compute&nbsp;R&nbsp;contribution&nbsp;from&nbsp;cluster1</td><td class="diff_next"></td><td class="diff_header" id="to2_191">191</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Compute&nbsp;R&nbsp;contribution&nbsp;from&nbsp;cluster1</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_192">192</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_cluster.R[i*num_dimensions+j]&nbsp;=&nbsp;((temp_cluster.means[i]-clusters.means[c1*num_dimensions+i])</td><td class="diff_next"></td><td class="diff_header" id="to2_192">192</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_cluster.R[i*num_dimensions+j]&nbsp;=&nbsp;((temp_cluster.means[i]-clusters.means[c1*num_dimensions+i])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_193">193</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(temp_cluster.means[j]-clusters.means[c1*num_dimensions+j])</td><td class="diff_next"></td><td class="diff_header" id="to2_193">193</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(temp_cluster.means[j]-clusters.means[c1*num_dimensions+j])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_194">194</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+clusters.R[c1*num_dimensions*num_dimensions+i*num_dimensions+j])*wt1;</td><td class="diff_next"></td><td class="diff_header" id="to2_194">194</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+clusters.R[c1*num_dimensions*num_dimensions+i*num_dimensions+j])*wt1;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_195">195</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Add&nbsp;R&nbsp;contribution&nbsp;from&nbsp;cluster2</td><td class="diff_next"></td><td class="diff_header" id="to2_195">195</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Add&nbsp;R&nbsp;contribution&nbsp;from&nbsp;cluster2</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_196">196</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_cluster.R[i*num_dimensions+j]&nbsp;+=&nbsp;((temp_cluster.means[i]-clusters.means[c2*num_dimensions+i])</td><td class="diff_next"></td><td class="diff_header" id="to2_196">196</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_cluster.R[i*num_dimensions+j]&nbsp;+=&nbsp;((temp_cluster.means[i]-clusters.means[c2*num_dimensions+i])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_197">197</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(temp_cluster.means[j]-clusters.means[c2*num_dimensions+j])</td><td class="diff_next"></td><td class="diff_header" id="to2_197">197</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*(temp_cluster.means[j]-clusters.means[c2*num_dimensions+j])</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_198">198</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+clusters.R[c2*num_dimensions*num_dimensions+i*num_dimensions+j])*wt2;</td><td class="diff_next"></td><td class="diff_header" id="to2_198">198</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+clusters.R[c2*num_dimensions*num_dimensions+i*num_dimensions+j])*wt2;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_199">199</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Because&nbsp;its&nbsp;symmetric...</td><td class="diff_next"></td><td class="diff_header" id="to2_199">199</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Because&nbsp;its&nbsp;symmetric...</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_200">200</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_cluster.R[j*num_dimensions+i]&nbsp;=&nbsp;temp_cluster.R[i*num_dimensions+j];</td><td class="diff_next"></td><td class="diff_header" id="to2_200">200</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_cluster.R[j*num_dimensions+i]&nbsp;=&nbsp;temp_cluster.R[i*num_dimensions+j];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_201">201</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_201">201</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_202">202</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_202">202</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_203">203</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_203">203</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_204">204</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Compute&nbsp;pi</td><td class="diff_next"></td><td class="diff_header" id="to2_204">204</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Compute&nbsp;pi</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_205">205</td><td nowrap="nowrap">&nbsp;&nbsp;temp_cluster.pi[0]&nbsp;=&nbsp;clusters.pi[c1]&nbsp;+&nbsp;clusters.pi[c2];</td><td class="diff_next"></td><td class="diff_header" id="to2_205">205</td><td nowrap="nowrap">&nbsp;&nbsp;temp_cluster.pi[0]&nbsp;=&nbsp;clusters.pi[c1]&nbsp;+&nbsp;clusters.pi[c2];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_206">206</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_206">206</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_207">207</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;compute&nbsp;N</td><td class="diff_next"></td><td class="diff_header" id="to2_207">207</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;compute&nbsp;N</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_208">208</td><td nowrap="nowrap">&nbsp;&nbsp;temp_cluster.N[0]&nbsp;=&nbsp;clusters.N[c1]&nbsp;+&nbsp;clusters.N[c2];</td><td class="diff_next"></td><td class="diff_header" id="to2_208">208</td><td nowrap="nowrap">&nbsp;&nbsp;temp_cluster.N[0]&nbsp;=&nbsp;clusters.N[c1]&nbsp;+&nbsp;clusters.N[c2];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_209">209</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_209">209</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_210">210</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;log_determinant;</td><td class="diff_next"></td><td class="diff_header" id="to2_210">210</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;log_determinant;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_211">211</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Copy&nbsp;R&nbsp;to&nbsp;Rinv&nbsp;matrix</td><td class="diff_next"></td><td class="diff_header" id="to2_211">211</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Copy&nbsp;R&nbsp;to&nbsp;Rinv&nbsp;matrix</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_212">212</td><td nowrap="nowrap">&nbsp;&nbsp;memcpy(temp_cluster.Rinv,temp_cluster.R,sizeof(float)*num_dimensions*num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_212">212</td><td nowrap="nowrap">&nbsp;&nbsp;memcpy(temp_cluster.Rinv,temp_cluster.R,sizeof(float)*num_dimensions*num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_213">213</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Invert&nbsp;the&nbsp;matrix</td><td class="diff_next"></td><td class="diff_header" id="to2_213">213</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Invert&nbsp;the&nbsp;matrix</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_214">214</td><td nowrap="nowrap">&nbsp;&nbsp;invert_cpu(temp_cluster.Rinv,num_dimensions,&amp;log_determinant);</td><td class="diff_next"></td><td class="diff_header" id="to2_214">214</td><td nowrap="nowrap">&nbsp;&nbsp;invert_cpu(temp_cluster.Rinv,num_dimensions,&amp;log_determinant);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_215">215</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Compute&nbsp;the&nbsp;constant</td><td class="diff_next"></td><td class="diff_header" id="to2_215">215</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Compute&nbsp;the&nbsp;constant</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_216">216</td><td nowrap="nowrap">&nbsp;&nbsp;temp_cluster.constant[0]&nbsp;=&nbsp;(-num_dimensions)*0.5f*::logf(2.0f*PI)-0.5f*log_determinant;</td><td class="diff_next"></td><td class="diff_header" id="to2_216">216</td><td nowrap="nowrap">&nbsp;&nbsp;temp_cluster.constant[0]&nbsp;=&nbsp;(-num_dimensions)*0.5f*::logf(2.0f*PI)-0.5f*log_determinant;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_217">217</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_217">217</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_218">218</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;avgvar&nbsp;same&nbsp;for&nbsp;all&nbsp;clusters</td><td class="diff_next"></td><td class="diff_header" id="to2_218">218</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;avgvar&nbsp;same&nbsp;for&nbsp;all&nbsp;clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_219">219</td><td nowrap="nowrap">&nbsp;&nbsp;temp_cluster.avgvar[0]&nbsp;=&nbsp;clusters.avgvar[0];</td><td class="diff_next"></td><td class="diff_header" id="to2_219">219</td><td nowrap="nowrap">&nbsp;&nbsp;temp_cluster.avgvar[0]&nbsp;=&nbsp;clusters.avgvar[0];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_220">220</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_220">220</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_221">221</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_221">221</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_222">222</td><td nowrap="nowrap">void&nbsp;copy_cluster(clusters_t&nbsp;&amp;dest,&nbsp;const&nbsp;int&nbsp;c_dest,&nbsp;clusters_t&nbsp;&amp;src,&nbsp;const&nbsp;int&nbsp;c_src,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_222">222</td><td nowrap="nowrap">void&nbsp;copy_cluster(clusters_t&nbsp;&amp;dest,&nbsp;const&nbsp;int&nbsp;c_dest,&nbsp;clusters_t&nbsp;&amp;src,&nbsp;const&nbsp;int&nbsp;c_src,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_223">223</td><td nowrap="nowrap">&nbsp;&nbsp;dest.N[c_dest]&nbsp;=&nbsp;src.N[c_src];</td><td class="diff_next"></td><td class="diff_header" id="to2_223">223</td><td nowrap="nowrap">&nbsp;&nbsp;dest.N[c_dest]&nbsp;=&nbsp;src.N[c_src];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_224">224</td><td nowrap="nowrap">&nbsp;&nbsp;dest.pi[c_dest]&nbsp;=&nbsp;src.pi[c_src];</td><td class="diff_next"></td><td class="diff_header" id="to2_224">224</td><td nowrap="nowrap">&nbsp;&nbsp;dest.pi[c_dest]&nbsp;=&nbsp;src.pi[c_src];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_225">225</td><td nowrap="nowrap">&nbsp;&nbsp;dest.constant[c_dest]&nbsp;=&nbsp;src.constant[c_src];</td><td class="diff_next"></td><td class="diff_header" id="to2_225">225</td><td nowrap="nowrap">&nbsp;&nbsp;dest.constant[c_dest]&nbsp;=&nbsp;src.constant[c_src];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_226">226</td><td nowrap="nowrap">&nbsp;&nbsp;dest.avgvar[c_dest]&nbsp;=&nbsp;src.avgvar[c_src];</td><td class="diff_next"></td><td class="diff_header" id="to2_226">226</td><td nowrap="nowrap">&nbsp;&nbsp;dest.avgvar[c_dest]&nbsp;=&nbsp;src.avgvar[c_src];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_227">227</td><td nowrap="nowrap">&nbsp;&nbsp;memcpy(&amp;(dest.means[c_dest*num_dimensions]),&amp;(src.means[c_src*num_dimensions]),sizeof(float)*num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_227">227</td><td nowrap="nowrap">&nbsp;&nbsp;memcpy(&amp;(dest.means[c_dest*num_dimensions]),&amp;(src.means[c_src*num_dimensions]),sizeof(float)*num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_228">228</td><td nowrap="nowrap">&nbsp;&nbsp;memcpy(&amp;(dest.R[c_dest*num_dimensions*num_dimensions]),&amp;(src.R[c_src*num_dimensions*num_dimensions]),sizeof(float)*num_dimensions*num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_228">228</td><td nowrap="nowrap">&nbsp;&nbsp;memcpy(&amp;(dest.R[c_dest*num_dimensions*num_dimensions]),&amp;(src.R[c_src*num_dimensions*num_dimensions]),sizeof(float)*num_dimensions*num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_229">229</td><td nowrap="nowrap">&nbsp;&nbsp;memcpy(&amp;(dest.Rinv[c_dest*num_dimensions*num_dimensions]),&amp;(src.Rinv[c_src*num_dimensions*num_dimensions]),sizeof(float)*num_dimensions*num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_229">229</td><td nowrap="nowrap">&nbsp;&nbsp;memcpy(&amp;(dest.Rinv[c_dest*num_dimensions*num_dimensions]),&amp;(src.Rinv[c_src*num_dimensions*num_dimensions]),sizeof(float)*num_dimensions*num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_230">230</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;do&nbsp;we&nbsp;need&nbsp;to&nbsp;copy&nbsp;memberships?</td><td class="diff_next"></td><td class="diff_header" id="to2_230">230</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;do&nbsp;we&nbsp;need&nbsp;to&nbsp;copy&nbsp;memberships?</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_231">231</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_231">231</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_232">232</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_232">232</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_233">233</td><td nowrap="nowrap">void&nbsp;printCluster(clusters_t&nbsp;&amp;clusters,&nbsp;const&nbsp;int&nbsp;c,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_233">233</td><td nowrap="nowrap">void&nbsp;printCluster(clusters_t&nbsp;&amp;clusters,&nbsp;const&nbsp;int&nbsp;c,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_234">234</td><td nowrap="nowrap">&nbsp;&nbsp;writeCluster(stdout,clusters,c,num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_234">234</td><td nowrap="nowrap">&nbsp;&nbsp;writeCluster(stdout,clusters,c,num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_235">235</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_235">235</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_236">236</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_236">236</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_237">237</td><td nowrap="nowrap">float&nbsp;cluster_distance(clusters_t&nbsp;&amp;clusters,&nbsp;const&nbsp;int&nbsp;c1,&nbsp;const&nbsp;int&nbsp;c2,&nbsp;clusters_t&nbsp;&amp;temp_cluster,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_237">237</td><td nowrap="nowrap">float&nbsp;cluster_distance(clusters_t&nbsp;&amp;clusters,&nbsp;const&nbsp;int&nbsp;c1,&nbsp;const&nbsp;int&nbsp;c2,&nbsp;clusters_t&nbsp;&amp;temp_cluster,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_238">238</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Add&nbsp;the&nbsp;clusters&nbsp;together,&nbsp;this&nbsp;updates&nbsp;pi,means,R,N&nbsp;and&nbsp;stores&nbsp;in&nbsp;temp_cluster</td><td class="diff_next"></td><td class="diff_header" id="to2_238">238</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Add&nbsp;the&nbsp;clusters&nbsp;together,&nbsp;this&nbsp;updates&nbsp;pi,means,R,N&nbsp;and&nbsp;stores&nbsp;in&nbsp;temp_cluster</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_239">239</td><td nowrap="nowrap">&nbsp;&nbsp;add_clusters(clusters,c1,c2,temp_cluster,num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_239">239</td><td nowrap="nowrap">&nbsp;&nbsp;add_clusters(clusters,c1,c2,temp_cluster,num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_240">240</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_240">240</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_241">241</td><td nowrap="nowrap">&nbsp;&nbsp;return&nbsp;clusters.N[c1]*clusters.constant[c1]&nbsp;+&nbsp;clusters.N[c2]*clusters.constant[c2]&nbsp;-&nbsp;temp_cluster.N[0]*temp_cluster.constant[0];</td><td class="diff_next"></td><td class="diff_header" id="to2_241">241</td><td nowrap="nowrap">&nbsp;&nbsp;return&nbsp;clusters.N[c1]*clusters.constant[c1]&nbsp;+&nbsp;clusters.N[c2]*clusters.constant[c2]&nbsp;-&nbsp;temp_cluster.N[0]*temp_cluster.constant[0];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_242">242</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_242">242</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_243">243</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_243">243</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_244">244</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_244">244</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_245">245</td><td nowrap="nowrap">//&nbsp;Free&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;host</td><td class="diff_next"></td><td class="diff_header" id="to2_245">245</td><td nowrap="nowrap">//&nbsp;Free&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;host</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_246">246</td><td nowrap="nowrap">void&nbsp;freeCluster(clusters_t*&nbsp;c)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_246">246</td><td nowrap="nowrap">void&nbsp;freeCluster(clusters_t*&nbsp;c)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_247">247</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;N);</td><td class="diff_next"></td><td class="diff_header" id="to2_247">247</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;N);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_248">248</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;pi);</td><td class="diff_next"></td><td class="diff_header" id="to2_248">248</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;pi);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_249">249</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;constant);</td><td class="diff_next"></td><td class="diff_header" id="to2_249">249</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;constant);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_250">250</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;avgvar);</td><td class="diff_next"></td><td class="diff_header" id="to2_250">250</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;avgvar);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_251">251</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;means);</td><td class="diff_next"></td><td class="diff_header" id="to2_251">251</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;means);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_252">252</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;R);</td><td class="diff_next"></td><td class="diff_header" id="to2_252">252</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;R);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_253">253</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;Rinv);</td><td class="diff_next"></td><td class="diff_header" id="to2_253">253</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;Rinv);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_254">254</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;memberships);</td><td class="diff_next"></td><td class="diff_header" id="to2_254">254</td><td nowrap="nowrap">&nbsp;&nbsp;free(c-&gt;memberships);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_255">255</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_255">255</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__0"></td><td class="diff_header" id="from2_256">256</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_256">256</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_257">257</td><td nowrap="nowrap">//&nbsp;Free&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_257">257</td><td nowrap="nowrap">//&nbsp;Free&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;device</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_258">258</td><td nowrap="nowrap">void&nbsp;freeClusterDevice(clusters_t&nbsp;*c)&nbsp;try&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_258">258</td><td nowrap="nowrap">void&nbsp;freeClusterDevice(clusters_t&nbsp;*c)&nbsp;try&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_259">259</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td><td class="diff_next"></td><td class="diff_header" id="to2_259">259</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_260">260</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td><td class="diff_next"></td><td class="diff_header" id="to2_260">260</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__1">n</a></td><td class="diff_header" id="from2_261">261</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__1">n</a></td><td class="diff_header" id="to2_261">261</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;sycl::free(c-&gt;N,&nbsp;q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_262">262</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:28:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header" id="to2_262">262</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;sycl::free(c-&gt;pi,&nbsp;q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_263">263</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_264">264</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_265">265</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((sycl::free(c-&gt;N,&nbsp;q_ct1),&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_266">266</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_267">267</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:30:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_268">268</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_269">269</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_270">270</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((sycl::free(c-&gt;pi,&nbsp;q_ct1),&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_271">271</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_272">272</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:31:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_273">273</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_274">274</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_275">275</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>sycl::free(c-&gt;constant,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_263">263</td><td nowrap="nowrap">&nbsp;&nbsp;sycl::free(c-&gt;constant,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_276">276</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header" id="to2_264">264</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;sycl::free(c-&gt;avgvar,&nbsp;q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_277">277</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:32:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header" id="to2_265">265</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;sycl::free(c-&gt;means,&nbsp;q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_278">278</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header" id="to2_266">266</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;sycl::free(c-&gt;R,&nbsp;q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_279">279</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header" id="to2_267">267</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;sycl::free(c-&gt;Rinv,&nbsp;q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_280">280</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((sycl::free(c-&gt;avgvar,&nbsp;q_ct1),&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_281">281</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_282">282</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:33:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_283">283</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_284">284</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_285">285</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((sycl::free(c-&gt;means,&nbsp;q_ct1),&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_286">286</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_287">287</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:34:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_288">288</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_289">289</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_290">290</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((sycl::free(c-&gt;R,&nbsp;q_ct1),&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_291">291</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_292">292</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:35:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_293">293</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_294">294</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_295">295</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((sycl::free(c-&gt;Rinv,&nbsp;q_ct1),&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_296">296</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_297">297</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:36:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_298">298</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_299">299</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_300">300</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>sycl::free(c-&gt;memberships,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_268">268</td><td nowrap="nowrap">&nbsp;&nbsp;sycl::free(c-&gt;memberships,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_301">301</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_269">269</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_302">302</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_270">270</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_303">303</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td><td class="diff_next"></td><td class="diff_header" id="to2_271">271</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_304">304</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td><td class="diff_next"></td><td class="diff_header" id="to2_272">272</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_305">305</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td><td class="diff_next"></td><td class="diff_header" id="to2_273">273</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_306">306</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_274">274</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_307">307</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_275">275</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_308">308</td><td nowrap="nowrap">//&nbsp;Setup&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;host</td><td class="diff_next"></td><td class="diff_header" id="to2_276">276</td><td nowrap="nowrap">//&nbsp;Setup&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;host</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_309">309</td><td nowrap="nowrap">void&nbsp;setupCluster(clusters_t*&nbsp;c,&nbsp;const&nbsp;int&nbsp;num_clusters,&nbsp;const&nbsp;int&nbsp;num_events,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_277">277</td><td nowrap="nowrap">void&nbsp;setupCluster(clusters_t*&nbsp;c,&nbsp;const&nbsp;int&nbsp;num_clusters,&nbsp;const&nbsp;int&nbsp;num_events,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_310">310</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;N&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_278">278</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;N&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_311">311</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;pi&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_279">279</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;pi&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_312">312</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;constant&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_280">280</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;constant&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_313">313</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;avgvar&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_281">281</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;avgvar&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_314">314</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;means&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_dimensions*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_282">282</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;means&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_dimensions*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_315">315</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;R&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_dimensions*num_dimensions*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_283">283</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;R&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_dimensions*num_dimensions*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_316">316</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;Rinv&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_dimensions*num_dimensions*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_284">284</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;Rinv&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_dimensions*num_dimensions*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_317">317</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;memberships&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_events*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_285">285</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;memberships&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_events*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_318">318</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_286">286</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_319">319</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_287">287</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_320">320</td><td nowrap="nowrap">//&nbsp;Setup&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_288">288</td><td nowrap="nowrap">//&nbsp;Setup&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;device</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__1"></td><td class="diff_header" id="from2_321">321</td><td nowrap="nowrap">clusters_t&nbsp;*setupClusterDevice(clusters_t&nbsp;*c,&nbsp;const&nbsp;int&nbsp;num_clusters,</td><td class="diff_next"></td><td class="diff_header" id="to2_289">289</td><td nowrap="nowrap">clusters_t&nbsp;*setupClusterDevice(clusters_t&nbsp;*c,&nbsp;const&nbsp;int&nbsp;num_clusters,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_322">322</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_events,</td><td class="diff_next"></td><td class="diff_header" id="to2_290">290</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_events,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_323">323</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;try&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_291">291</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;try&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_324">324</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td><td class="diff_next"></td><td class="diff_header" id="to2_292">292</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_325">325</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td><td class="diff_next"></td><td class="diff_header" id="to2_293">293</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__2">n</a></td><td class="diff_header" id="from2_326">326</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__2">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_327">327</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:37:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_328">328</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_329">329</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_330">330</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>c-&gt;N&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(num_clusters,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_294">294</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;N&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(num_clusters,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_331">331</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_332">332</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:38:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_333">333</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_334">334</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_335">335</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>c-&gt;pi&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(num_clusters,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_295">295</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;pi&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(num_clusters,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_336">336</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_337">337</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:39:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_338">338</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_339">339</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_340">340</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_341">341</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>c-&gt;constant&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(num_clusters,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_296">296</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;constant&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(num_clusters,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_342">342</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_343">343</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:40:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_344">344</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_345">345</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_346">346</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_347">347</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>c-&gt;avgvar&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(num_clusters,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_297">297</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;avgvar&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(num_clusters,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_348">348</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_349">349</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:41:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_350">350</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_351">351</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_352">352</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((c-&gt;means&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_353">353</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_clusters,&nbsp;q_ct1),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_354">354</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_355">355</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_356">356</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:42:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_357">357</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_358">358</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_359">359</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_360">360</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>c-&gt;<span class="diff_chg">R</span>&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_298">298</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;<span class="diff_chg">means</span>&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*<span class="diff_add">&nbsp;num_clusters,&nbsp;q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_361">361</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_dimensions&nbsp;*&nbsp;num_clusters,</span></td><td class="diff_next"></td><td class="diff_header" id="to2_299">299</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;c-&gt;R&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*num_dimensions&nbsp;*&nbsp;num_clusters,q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_362">362</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_363">363</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_364">364</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_365">365</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:43:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_366">366</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_367">367</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_368">368</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_369">369</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>c-&gt;Rinv&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_300">300</td><td nowrap="nowrap">&nbsp;&nbsp;c-&gt;Rinv&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*<span class="diff_add">num_dimensions&nbsp;*&nbsp;num_clusters,q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_370">370</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_dimensions&nbsp;*&nbsp;num_clusters,</span></td><td class="diff_next"></td><td class="diff_header" id="to2_301">301</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;c-&gt;memberships&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(sizeof(float)&nbsp;*&nbsp;num_events&nbsp;*(num_clusters&nbsp;+&nbsp;NUM_CLUSTERS_PER_BLOCK&nbsp;-num_clusters&nbsp;%&nbsp;NUM_CLUSTERS_PER_BLOCK),q_ct1);</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_371">371</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_372">372</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_373">373</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_374">374</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:44:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_375">375</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_376">376</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_377">377</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((c-&gt;memberships&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_378">378</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_events&nbsp;*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_379">379</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(num_clusters&nbsp;+&nbsp;NUM_CLUSTERS_PER_BLOCK&nbsp;-</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__2"></td><td class="diff_header" id="from2_380">380</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters&nbsp;%&nbsp;NUM_CLUSTERS_PER_BLOCK),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_381">381</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_382">382</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_383">383</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_302">302</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_384">384</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t*&nbsp;d_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_303">303</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t*&nbsp;d_clusters;</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__3">n</a></td><td class="diff_header" id="from2_385">385</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__3">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_386">386</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:45:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__3"></td><td class="diff_header" id="from2_387">387</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_388">388</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_389">389</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>d_clusters&nbsp;=&nbsp;sycl::malloc_device&lt;clusters_t&gt;(1,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_304">304</td><td nowrap="nowrap">&nbsp;&nbsp;d_clusters&nbsp;=&nbsp;sycl::malloc_device&lt;clusters_t&gt;(1,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_390">390</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_305">305</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_391">391</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Copy&nbsp;Cluster&nbsp;data&nbsp;to&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_306">306</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Copy&nbsp;Cluster&nbsp;data&nbsp;to&nbsp;device</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__4">n</a></td><td class="diff_header" id="from2_392">392</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__4">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_393">393</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:46:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_394">394</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_395">395</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_396">396</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>q_ct1.memcpy(d_clusters,&nbsp;c,&nbsp;sizeof(clusters_t)).wait()<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_307">307</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(d_clusters,&nbsp;c,&nbsp;sizeof(clusters_t)).wait();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_397">397</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Finished&nbsp;copying&nbsp;cluster&nbsp;data&nbsp;to&nbsp;device.\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_308">308</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Finished&nbsp;copying&nbsp;cluster&nbsp;data&nbsp;to&nbsp;device.\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_398">398</td><td nowrap="nowrap">&nbsp;&nbsp;return&nbsp;d_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_309">309</td><td nowrap="nowrap">&nbsp;&nbsp;return&nbsp;d_clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_399">399</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_310">310</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_400">400</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_311">311</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_401">401</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td><td class="diff_next"></td><td class="diff_header" id="to2_312">312</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_402">402</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td><td class="diff_next"></td><td class="diff_header" id="to2_313">313</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_403">403</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td><td class="diff_next"></td><td class="diff_header" id="to2_314">314</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_404">404</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_315">315</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_405">405</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_316">316</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_406">406</td><td nowrap="nowrap">void&nbsp;copyClusterFromDevice(clusters_t&nbsp;*c,&nbsp;clusters_t&nbsp;*c_tmp,&nbsp;clusters_t&nbsp;*d_c,</td><td class="diff_next"></td><td class="diff_header" id="to2_317">317</td><td nowrap="nowrap">void&nbsp;copyClusterFromDevice(clusters_t&nbsp;*c,&nbsp;clusters_t&nbsp;*c_tmp,&nbsp;clusters_t&nbsp;*d_c,</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__4"></td><td class="diff_header" id="from2_407">407</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_clusters,</td><td class="diff_next"></td><td class="diff_header" id="to2_318">318</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_clusters,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_408">408</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;try&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_319">319</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;try&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_409">409</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td><td class="diff_next"></td><td class="diff_header" id="to2_320">320</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_410">410</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td><td class="diff_next"></td><td class="diff_header" id="to2_321">321</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_411">411</td><td nowrap="nowrap">&nbsp;&nbsp;if&nbsp;(d_c&nbsp;!=&nbsp;NULL)</td><td class="diff_next"></td><td class="diff_header" id="to2_322">322</td><td nowrap="nowrap">&nbsp;&nbsp;if&nbsp;(d_c&nbsp;!=&nbsp;NULL)</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__5">n</a></td><td class="diff_header" id="from2_412">412</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__5">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__5"></td><td class="diff_header" id="from2_413">413</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:47:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_414">414</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_415">415</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_416">416</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>q_ct1.memcpy(c_tmp,&nbsp;d_c,&nbsp;sizeof(clusters_t)).wait()<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_323">323</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(c_tmp,&nbsp;d_c,&nbsp;sizeof(clusters_t)).wait();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_417">417</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;copy&nbsp;all&nbsp;of&nbsp;the&nbsp;arrays&nbsp;from&nbsp;the&nbsp;structs</td><td class="diff_next"></td><td class="diff_header" id="to2_324">324</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;copy&nbsp;all&nbsp;of&nbsp;the&nbsp;arrays&nbsp;from&nbsp;the&nbsp;structs</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__6">n</a></td><td class="diff_header" id="from2_418">418</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__6">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_419">419</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:48:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_420">420</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_421">421</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_422">422</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_423">423</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(c-&gt;N,&nbsp;c_tmp-&gt;N,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters).wait()<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_325">325</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(c-&gt;N,&nbsp;c_tmp-&gt;N,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters).wait();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_424">424</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_425">425</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:49:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_426">426</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_427">427</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_428">428</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_429">429</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(c-&gt;pi,&nbsp;c_tmp-&gt;pi,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters).wait()<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_326">326</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(c-&gt;pi,&nbsp;c_tmp-&gt;pi,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters).wait();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_430">430</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_431">431</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:50:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_432">432</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_433">433</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_434">434</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_435">435</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(c-&gt;constant,&nbsp;c_tmp-&gt;constant,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)</td><td class="diff_next"></td><td class="diff_header" id="to2_327">327</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(c-&gt;constant,&nbsp;c_tmp-&gt;constant,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)<span class="diff_add">.wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_436">436</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_437">437</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_438">438</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_439">439</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:51:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_440">440</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_441">441</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_442">442</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_443">443</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(c-&gt;avgvar,&nbsp;c_tmp-&gt;avgvar,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)</td><td class="diff_next"></td><td class="diff_header" id="to2_328">328</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(c-&gt;avgvar,&nbsp;c_tmp-&gt;avgvar,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)<span class="diff_add">.wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_444">444</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header" id="to2_329">329</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;q_ct1.memcpy(c-&gt;means,&nbsp;c_tmp-&gt;means,sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_clusters).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_445">445</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header" id="to2_330">330</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;q_ct1.memcpy(c-&gt;R,&nbsp;c_tmp-&gt;R,sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions&nbsp;*num_clusters).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_446">446</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header" id="to2_331">331</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;q_ct1.memcpy(c-&gt;Rinv,&nbsp;c_tmp-&gt;Rinv,sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions&nbsp;*num_clusters).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_447">447</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:52:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_448">448</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_449">449</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_450">450</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_451">451</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(c-&gt;means,&nbsp;c_tmp-&gt;means,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_452">452</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_clusters)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_453">453</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_454">454</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_455">455</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_456">456</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:53:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_457">457</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_458">458</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_459">459</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_460">460</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(c-&gt;R,&nbsp;c_tmp-&gt;R,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_461">461</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions&nbsp;*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_462">462</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_463">463</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_464">464</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_465">465</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_466">466</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:54:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_467">467</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_468">468</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_469">469</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_470">470</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(c-&gt;Rinv,&nbsp;c_tmp-&gt;Rinv,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_471">471</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions&nbsp;*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_472">472</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_473">473</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_474">474</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_475">475</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_332">332</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_476">476</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_333">333</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_477">477</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td><td class="diff_next"></td><td class="diff_header" id="to2_334">334</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_478">478</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td><td class="diff_next"></td><td class="diff_header" id="to2_335">335</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_479">479</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td><td class="diff_next"></td><td class="diff_header" id="to2_336">336</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_480">480</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_337">337</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__6"></td><td class="diff_header" id="from2_481">481</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_338">338</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_482">482</td><td nowrap="nowrap">void&nbsp;copyClusterToDevice(clusters_t&nbsp;*c,&nbsp;clusters_t&nbsp;*c_tmp,</td><td class="diff_next"></td><td class="diff_header" id="to2_339">339</td><td nowrap="nowrap">void&nbsp;copyClusterToDevice(clusters_t&nbsp;*c,&nbsp;clusters_t&nbsp;*c_tmp,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_483">483</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_clusters,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;try&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_340">340</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;int&nbsp;num_clusters,&nbsp;const&nbsp;int&nbsp;num_dimensions)&nbsp;try&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_484">484</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td><td class="diff_next"></td><td class="diff_header" id="to2_341">341</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_485">485</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td><td class="diff_next"></td><td class="diff_header" id="to2_342">342</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__7">n</a></td><td class="diff_header" id="from2_486">486</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__7">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_487">487</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:55:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_488">488</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_489">489</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_490">490</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_491">491</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(c_tmp-&gt;N,&nbsp;c-&gt;N,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters).wait()<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_343">343</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(c_tmp-&gt;N,&nbsp;c-&gt;N,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters).wait();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_492">492</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_493">493</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:56:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_494">494</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_495">495</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_496">496</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_497">497</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(c_tmp-&gt;pi,&nbsp;c-&gt;pi,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters).wait()<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_344">344</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(c_tmp-&gt;pi,&nbsp;c-&gt;pi,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters).wait();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_498">498</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_499">499</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:57:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_500">500</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_501">501</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_502">502</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_503">503</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(c_tmp-&gt;constant,&nbsp;c-&gt;constant,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)</td><td class="diff_next"></td><td class="diff_header" id="to2_345">345</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(c_tmp-&gt;constant,&nbsp;c-&gt;constant,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)<span class="diff_add">.wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_504">504</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_505">505</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_506">506</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_507">507</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:58:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_508">508</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_509">509</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_510">510</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_511">511</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(c_tmp-&gt;avgvar,&nbsp;c-&gt;avgvar,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)</td><td class="diff_next"></td><td class="diff_header" id="to2_346">346</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(c_tmp-&gt;avgvar,&nbsp;c-&gt;avgvar,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)<span class="diff_add">.wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_512">512</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header" id="to2_347">347</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;q_ct1.memcpy(c_tmp-&gt;means,&nbsp;c-&gt;means,sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_clusters).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_513">513</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header" id="to2_348">348</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;q_ct1.memcpy(c_tmp-&gt;R,&nbsp;c-&gt;R,sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions&nbsp;*num_clusters).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_514">514</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header" id="to2_349">349</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;q_ct1.memcpy(c_tmp-&gt;Rinv,&nbsp;c-&gt;Rinv,sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions&nbsp;*num_clusters).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_515">515</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:59:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_516">516</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_517">517</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_518">518</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_519">519</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(c_tmp-&gt;means,&nbsp;c-&gt;means,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_520">520</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_clusters)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_521">521</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_522">522</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_523">523</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_524">524</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:60:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_525">525</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_526">526</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_527">527</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_528">528</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(c_tmp-&gt;R,&nbsp;c-&gt;R,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_529">529</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions&nbsp;*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_530">530</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_531">531</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_532">532</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_533">533</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_534">534</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:61:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_535">535</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_536">536</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_537">537</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_538">538</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(c_tmp-&gt;Rinv,&nbsp;c-&gt;Rinv,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_539">539</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions&nbsp;*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_540">540</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_541">541</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_542">542</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_543">543</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_350">350</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_544">544</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_351">351</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_545">545</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td><td class="diff_next"></td><td class="diff_header" id="to2_352">352</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_546">546</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td><td class="diff_next"></td><td class="diff_header" id="to2_353">353</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_547">547</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td><td class="diff_next"></td><td class="diff_header" id="to2_354">354</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_548">548</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_355">355</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_549">549</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_356">356</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_550">550</td><td nowrap="nowrap">clusters_t&nbsp;*cluster(int&nbsp;original_num_clusters,&nbsp;int&nbsp;desired_num_clusters,</td><td class="diff_next"></td><td class="diff_header" id="to2_357">357</td><td nowrap="nowrap">clusters_t&nbsp;*cluster(int&nbsp;original_num_clusters,&nbsp;int&nbsp;desired_num_clusters,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_551">551</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;*final_num_clusters,&nbsp;int&nbsp;num_dimensions,&nbsp;int&nbsp;num_events,</td><td class="diff_next"></td><td class="diff_header" id="to2_358">358</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;*final_num_clusters,&nbsp;int&nbsp;num_dimensions,&nbsp;int&nbsp;num_events,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_552">552</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;*fcs_data_by_event)&nbsp;try&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_359">359</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;*fcs_data_by_event)&nbsp;try&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_553">553</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td><td class="diff_next"></td><td class="diff_header" id="to2_360">360</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;dpct::device_ext&nbsp;&amp;dev_ct1&nbsp;=&nbsp;dpct::get_current_device();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_554">554</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td><td class="diff_next"></td><td class="diff_header" id="to2_361">361</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::queue&nbsp;&amp;q_ct1&nbsp;=&nbsp;dev_ct1.default_queue();</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_555">555</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_362">362</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_556">556</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;regroup_iterations&nbsp;=&nbsp;0;</td><td class="diff_next"></td><td class="diff_header" id="to2_363">363</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;regroup_iterations&nbsp;=&nbsp;0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_557">557</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;params_iterations&nbsp;=&nbsp;0;</td><td class="diff_next"></td><td class="diff_header" id="to2_364">364</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;params_iterations&nbsp;=&nbsp;0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_558">558</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;reduce_iterations&nbsp;=&nbsp;0;</td><td class="diff_next"></td><td class="diff_header" id="to2_365">365</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;reduce_iterations&nbsp;=&nbsp;0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_559">559</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;ideal_num_clusters&nbsp;=&nbsp;original_num_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_366">366</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;ideal_num_clusters&nbsp;=&nbsp;original_num_clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_560">560</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;stop_number;</td><td class="diff_next"></td><td class="diff_header" id="to2_367">367</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;stop_number;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_561">561</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_368">368</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_562">562</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Number&nbsp;of&nbsp;clusters&nbsp;to&nbsp;stop&nbsp;iterating&nbsp;at.</td><td class="diff_next"></td><td class="diff_header" id="to2_369">369</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Number&nbsp;of&nbsp;clusters&nbsp;to&nbsp;stop&nbsp;iterating&nbsp;at.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_563">563</td><td nowrap="nowrap">&nbsp;&nbsp;if(desired_num_clusters&nbsp;==&nbsp;0)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_370">370</td><td nowrap="nowrap">&nbsp;&nbsp;if(desired_num_clusters&nbsp;==&nbsp;0)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_564">564</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;stop_number&nbsp;=&nbsp;1;</td><td class="diff_next"></td><td class="diff_header" id="to2_371">371</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;stop_number&nbsp;=&nbsp;1;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_565">565</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_372">372</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;else&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_566">566</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;stop_number&nbsp;=&nbsp;desired_num_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_373">373</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;stop_number&nbsp;=&nbsp;desired_num_clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_567">567</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_374">374</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_568">568</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_375">375</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_569">569</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Transpose&nbsp;the&nbsp;event&nbsp;data&nbsp;(allows&nbsp;coalesced&nbsp;access&nbsp;pattern&nbsp;in&nbsp;E-step&nbsp;kernel)</td><td class="diff_next"></td><td class="diff_header" id="to2_376">376</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Transpose&nbsp;the&nbsp;event&nbsp;data&nbsp;(allows&nbsp;coalesced&nbsp;access&nbsp;pattern&nbsp;in&nbsp;E-step&nbsp;kernel)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_570">570</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;This&nbsp;has&nbsp;consecutive&nbsp;values&nbsp;being&nbsp;from&nbsp;the&nbsp;same&nbsp;dimension&nbsp;of&nbsp;the&nbsp;data&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_377">377</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;This&nbsp;has&nbsp;consecutive&nbsp;values&nbsp;being&nbsp;from&nbsp;the&nbsp;same&nbsp;dimension&nbsp;of&nbsp;the&nbsp;data&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_571">571</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;(num_dimensions&nbsp;by&nbsp;num_events&nbsp;matrix)</td><td class="diff_next"></td><td class="diff_header" id="to2_378">378</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;(num_dimensions&nbsp;by&nbsp;num_events&nbsp;matrix)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_572">572</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;fcs_data_by_dimension&nbsp;&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_events*num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_379">379</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;fcs_data_by_dimension&nbsp;&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*num_events*num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_573">573</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_380">380</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_574">574</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;e=0;&nbsp;e&lt;num_events;&nbsp;e++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_381">381</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;e=0;&nbsp;e&lt;num_events;&nbsp;e++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_575">575</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&lt;num_dimensions;&nbsp;d++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_382">382</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&lt;num_dimensions;&nbsp;d++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_576">576</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isnan(fcs_data_by_event[e*num_dimensions+d]))&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_383">383</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(isnan(fcs_data_by_event[e*num_dimensions+d]))&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_577">577</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Error:&nbsp;Found&nbsp;NaN&nbsp;value&nbsp;in&nbsp;input&nbsp;data.&nbsp;Exiting.\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_384">384</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;printf("Error:&nbsp;Found&nbsp;NaN&nbsp;value&nbsp;in&nbsp;input&nbsp;data.&nbsp;Exiting.\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_578">578</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NULL;</td><td class="diff_next"></td><td class="diff_header" id="to2_385">385</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;NULL;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_579">579</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_386">386</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_580">580</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcs_data_by_dimension[d*num_events+e]&nbsp;=&nbsp;fcs_data_by_event[e*num_dimensions+d];</td><td class="diff_next"></td><td class="diff_header" id="to2_387">387</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fcs_data_by_dimension[d*num_events+e]&nbsp;=&nbsp;fcs_data_by_event[e*num_dimensions+d];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_581">581</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_388">388</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_582">582</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_389">389</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_583">583</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_390">390</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_584">584</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_391">391</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_585">585</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("Number&nbsp;of&nbsp;events:&nbsp;%d\n",num_events);</td><td class="diff_next"></td><td class="diff_header" id="to2_392">392</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("Number&nbsp;of&nbsp;events:&nbsp;%d\n",num_events);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_586">586</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("Number&nbsp;of&nbsp;dimensions:&nbsp;%d\n\n",num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_393">393</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("Number&nbsp;of&nbsp;dimensions:&nbsp;%d\n\n",num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_587">587</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("Starting&nbsp;with&nbsp;%d&nbsp;cluster(s),&nbsp;will&nbsp;stop&nbsp;at&nbsp;%d&nbsp;cluster(s).\n",original_num_clusters,stop_number);</td><td class="diff_next"></td><td class="diff_header" id="to2_394">394</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("Starting&nbsp;with&nbsp;%d&nbsp;cluster(s),&nbsp;will&nbsp;stop&nbsp;at&nbsp;%d&nbsp;cluster(s).\n",original_num_clusters,stop_number);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_588">588</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_395">395</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_589">589</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;This&nbsp;the&nbsp;shared&nbsp;memory&nbsp;space&nbsp;between&nbsp;the&nbsp;GPUs</td><td class="diff_next"></td><td class="diff_header" id="to2_396">396</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;This&nbsp;the&nbsp;shared&nbsp;memory&nbsp;space&nbsp;between&nbsp;the&nbsp;GPUs</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_590">590</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_397">397</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_591">591</td><td nowrap="nowrap">&nbsp;&nbsp;setupCluster(&amp;clusters,&nbsp;original_num_clusters,&nbsp;num_events,&nbsp;num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_398">398</td><td nowrap="nowrap">&nbsp;&nbsp;setupCluster(&amp;clusters,&nbsp;original_num_clusters,&nbsp;num_events,&nbsp;num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_592">592</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_399">399</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_593">593</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_400">400</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_594">594</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;another&nbsp;set&nbsp;of&nbsp;clusters&nbsp;for&nbsp;saving&nbsp;the&nbsp;results&nbsp;of&nbsp;the&nbsp;best&nbsp;configuration</td><td class="diff_next"></td><td class="diff_header" id="to2_401">401</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;another&nbsp;set&nbsp;of&nbsp;clusters&nbsp;for&nbsp;saving&nbsp;the&nbsp;results&nbsp;of&nbsp;the&nbsp;best&nbsp;configuration</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_595">595</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;*saved_clusters&nbsp;=&nbsp;(clusters_t*)&nbsp;malloc(sizeof(clusters_t));</td><td class="diff_next"></td><td class="diff_header" id="to2_402">402</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;*saved_clusters&nbsp;=&nbsp;(clusters_t*)&nbsp;malloc(sizeof(clusters_t));</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_596">596</td><td nowrap="nowrap">&nbsp;&nbsp;setupCluster(saved_clusters,&nbsp;original_num_clusters,&nbsp;num_events,&nbsp;num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_403">403</td><td nowrap="nowrap">&nbsp;&nbsp;setupCluster(saved_clusters,&nbsp;original_num_clusters,&nbsp;num_events,&nbsp;num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_597">597</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_404">404</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_598">598</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Finished&nbsp;allocating&nbsp;shared&nbsp;cluster&nbsp;structures&nbsp;on&nbsp;host\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_405">405</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Finished&nbsp;allocating&nbsp;shared&nbsp;cluster&nbsp;structures&nbsp;on&nbsp;host\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_599">599</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_406">406</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_600">600</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;hold&nbsp;the&nbsp;result&nbsp;from&nbsp;regroup&nbsp;kernel</td><td class="diff_next"></td><td class="diff_header" id="to2_407">407</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;hold&nbsp;the&nbsp;result&nbsp;from&nbsp;regroup&nbsp;kernel</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_601">601</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;shared_likelihoods&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*NUM_BLOCKS);</td><td class="diff_next"></td><td class="diff_header" id="to2_408">408</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;shared_likelihoods&nbsp;=&nbsp;(float*)&nbsp;malloc(sizeof(float)*NUM_BLOCKS);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_602">602</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;likelihood,&nbsp;old_likelihood;</td><td class="diff_next"></td><td class="diff_header" id="to2_409">409</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;likelihood,&nbsp;old_likelihood;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_603">603</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;min_rissanen&nbsp;=&nbsp;FLT_MAX;</td><td class="diff_next"></td><td class="diff_header" id="to2_410">410</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;min_rissanen&nbsp;=&nbsp;FLT_MAX;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_604">604</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_411">411</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_605">605</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Used&nbsp;as&nbsp;a&nbsp;temporary&nbsp;cluster&nbsp;for&nbsp;combining&nbsp;clusters&nbsp;in&nbsp;"distance"&nbsp;computations</td><td class="diff_next"></td><td class="diff_header" id="to2_412">412</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Used&nbsp;as&nbsp;a&nbsp;temporary&nbsp;cluster&nbsp;for&nbsp;combining&nbsp;clusters&nbsp;in&nbsp;"distance"&nbsp;computations</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_606">606</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;scratch_cluster;</td><td class="diff_next"></td><td class="diff_header" id="to2_413">413</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;scratch_cluster;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_607">607</td><td nowrap="nowrap">&nbsp;&nbsp;setupCluster(&amp;scratch_cluster,&nbsp;1,&nbsp;num_events,&nbsp;num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_414">414</td><td nowrap="nowrap">&nbsp;&nbsp;setupCluster(&amp;scratch_cluster,&nbsp;1,&nbsp;num_events,&nbsp;num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_608">608</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_415">415</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_609">609</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Finished&nbsp;allocating&nbsp;memory&nbsp;on&nbsp;host&nbsp;for&nbsp;clusters.\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_416">416</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Finished&nbsp;allocating&nbsp;memory&nbsp;on&nbsp;host&nbsp;for&nbsp;clusters.\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_610">610</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_417">417</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_611">611</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Setup&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_418">418</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Setup&nbsp;the&nbsp;cluster&nbsp;data&nbsp;structures&nbsp;on&nbsp;device</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_612">612</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;First&nbsp;allocate&nbsp;structures&nbsp;on&nbsp;the&nbsp;host,&nbsp;CUDA&nbsp;malloc&nbsp;the&nbsp;arrays</td><td class="diff_next"></td><td class="diff_header" id="to2_419">419</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;First&nbsp;allocate&nbsp;structures&nbsp;on&nbsp;the&nbsp;host,&nbsp;CUDA&nbsp;malloc&nbsp;the&nbsp;arrays</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_613">613</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Then&nbsp;CUDA&nbsp;malloc&nbsp;structures&nbsp;on&nbsp;the&nbsp;device&nbsp;and&nbsp;copy&nbsp;them&nbsp;over</td><td class="diff_next"></td><td class="diff_header" id="to2_420">420</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Then&nbsp;CUDA&nbsp;malloc&nbsp;structures&nbsp;on&nbsp;the&nbsp;device&nbsp;and&nbsp;copy&nbsp;them&nbsp;over</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_614">614</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;temp_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_421">421</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;temp_clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_615">615</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;*d_clusters&nbsp;=&nbsp;setupClusterDevice(&amp;temp_clusters,&nbsp;original_num_clusters,&nbsp;num_events,&nbsp;num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_422">422</td><td nowrap="nowrap">&nbsp;&nbsp;clusters_t&nbsp;*d_clusters&nbsp;=&nbsp;setupClusterDevice(&amp;temp_clusters,&nbsp;original_num_clusters,&nbsp;num_events,&nbsp;num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_616">616</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_423">423</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_617">617</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;allocate&nbsp;device&nbsp;memory&nbsp;for&nbsp;FCS&nbsp;data</td><td class="diff_next"></td><td class="diff_header" id="to2_424">424</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;allocate&nbsp;device&nbsp;memory&nbsp;for&nbsp;FCS&nbsp;data</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__7"></td><td class="diff_header" id="from2_618">618</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;d_fcs_data_by_event;</td><td class="diff_next"></td><td class="diff_header" id="to2_425">425</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;d_fcs_data_by_event;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_619">619</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;d_fcs_data_by_dimension;</td><td class="diff_next"></td><td class="diff_header" id="to2_426">426</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;d_fcs_data_by_dimension;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_620">620</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_427">427</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_621">621</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;allocate&nbsp;and&nbsp;copy&nbsp;relavant&nbsp;FCS&nbsp;data&nbsp;to&nbsp;device.</td><td class="diff_next"></td><td class="diff_header" id="to2_428">428</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;allocate&nbsp;and&nbsp;copy&nbsp;relavant&nbsp;FCS&nbsp;data&nbsp;to&nbsp;device.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_622">622</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;mem_size&nbsp;=&nbsp;num_dimensions&nbsp;*&nbsp;num_events&nbsp;*&nbsp;sizeof(float);</td><td class="diff_next"></td><td class="diff_header" id="to2_429">429</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;mem_size&nbsp;=&nbsp;num_dimensions&nbsp;*&nbsp;num_events&nbsp;*&nbsp;sizeof(float);</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__8">n</a></td><td class="diff_header" id="from2_623">623</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__8">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_624">624</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:62:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_625">625</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_626">626</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_627">627</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_628">628</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>d_fcs_data_by_event&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(mem_size,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_430">430</td><td nowrap="nowrap">&nbsp;&nbsp;d_fcs_data_by_event&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(mem_size,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_629">629</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_630">630</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:63:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_631">631</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_632">632</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_633">633</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_634">634</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>d_fcs_data_by_dimension&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(mem_size,&nbsp;q_ct1)<span class="diff_chg">,</span></td><td class="diff_next"></td><td class="diff_header" id="to2_431">431</td><td nowrap="nowrap">&nbsp;&nbsp;d_fcs_data_by_dimension&nbsp;=&nbsp;(float&nbsp;*)sycl::malloc_device(mem_size,&nbsp;q_ct1)<span class="diff_chg">;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_635">635</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_636">636</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_637">637</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:64:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_638">638</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_639">639</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_640">640</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_641">641</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(d_fcs_data_by_event,&nbsp;fcs_data_by_event,&nbsp;mem_size).wait()<span class="diff_chg">,</span></td><td class="diff_next"></td><td class="diff_header" id="to2_432">432</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(d_fcs_data_by_event,&nbsp;fcs_data_by_event,&nbsp;mem_size).wait()<span class="diff_chg">;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_642">642</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_643">643</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_644">644</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:65:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_645">645</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_646">646</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_647">647</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_648">648</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>q_ct1.memcpy(d_fcs_data_by_dimension,&nbsp;fcs_data_by_dimension,&nbsp;mem_size)</td><td class="diff_next"></td><td class="diff_header" id="to2_433">433</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.memcpy(d_fcs_data_by_dimension,&nbsp;fcs_data_by_dimension,&nbsp;mem_size)<span class="diff_add">.wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_649">649</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_650">650</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_651">651</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_434">434</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_652">652</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("GPU:&nbsp;Finished&nbsp;copying&nbsp;FCS&nbsp;data&nbsp;to&nbsp;device.\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_435">435</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("GPU:&nbsp;Finished&nbsp;copying&nbsp;FCS&nbsp;data&nbsp;to&nbsp;device.\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_653">653</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_436">436</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_654">654</td><td nowrap="nowrap">&nbsp;&nbsp;////////////////&nbsp;Initialization&nbsp;done,&nbsp;starting&nbsp;kernels&nbsp;////////////////</td><td class="diff_next"></td><td class="diff_header" id="to2_437">437</td><td nowrap="nowrap">&nbsp;&nbsp;////////////////&nbsp;Initialization&nbsp;done,&nbsp;starting&nbsp;kernels&nbsp;////////////////</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_655">655</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Invoking&nbsp;seed_clusters&nbsp;kernel.\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_438">438</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Invoking&nbsp;seed_clusters&nbsp;kernel.\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_656">656</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_439">439</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_657">657</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;seed_clusters&nbsp;sets&nbsp;initial&nbsp;pi&nbsp;values,</td><td class="diff_next"></td><td class="diff_header" id="to2_440">440</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;seed_clusters&nbsp;sets&nbsp;initial&nbsp;pi&nbsp;values,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_658">658</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;finds&nbsp;the&nbsp;means&nbsp;/&nbsp;covariances&nbsp;and&nbsp;copies&nbsp;it&nbsp;to&nbsp;all&nbsp;the&nbsp;clusters</td><td class="diff_next"></td><td class="diff_header" id="to2_441">441</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;finds&nbsp;the&nbsp;means&nbsp;/&nbsp;covariances&nbsp;and&nbsp;copies&nbsp;it&nbsp;to&nbsp;all&nbsp;the&nbsp;clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_659">659</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_442">442</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_660">660</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_443">443</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_661">661</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_444">444</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_662">662</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_acc_ct1(sycl::range&lt;1&gt;(24&nbsp;/*NUM_DIMENSIONS*/),&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_445">445</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_acc_ct1(sycl::range&lt;1&gt;(24&nbsp;/*NUM_DIMENSIONS*/),&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_663">663</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_446">446</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_664">664</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_447">447</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_665">665</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avgvar_acc_ct1(cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_448">448</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avgvar_acc_ct1(cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_666">666</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_449">449</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_667">667</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_450">450</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_668">668</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variances_acc_ct1(sycl::range&lt;1&gt;(24&nbsp;/*NUM_DIMENSIONS*/),&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_451">451</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variances_acc_ct1(sycl::range&lt;1&gt;(24&nbsp;/*NUM_DIMENSIONS*/),&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_669">669</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_452">452</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_670">670</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_453">453</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_671">671</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_variance_acc_ct1(cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_454">454</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_variance_acc_ct1(cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_672">672</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_455">455</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_673">673</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP),</td><td class="diff_next"></td><td class="diff_header" id="to2_456">456</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_674">674</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP)),</td><td class="diff_next"></td><td class="diff_header" id="to2_457">457</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP)),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_675">675</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_458">458</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_676">676</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seed_clusters_kernel(</td><td class="diff_next"></td><td class="diff_header" id="to2_459">459</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;seed_clusters_kernel(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_677">677</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d_fcs_data_by_event,&nbsp;d_clusters,&nbsp;num_dimensions,</td><td class="diff_next"></td><td class="diff_header" id="to2_460">460</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d_fcs_data_by_event,&nbsp;d_clusters,&nbsp;num_dimensions,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_678">678</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;original_num_clusters,&nbsp;num_events,&nbsp;item_ct1,</td><td class="diff_next"></td><td class="diff_header" id="to2_461">461</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;original_num_clusters,&nbsp;num_events,&nbsp;item_ct1,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_679">679</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_462">462</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_680">680</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avgvar_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_463">463</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avgvar_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_681">681</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variances_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_464">464</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;variances_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_682">682</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_variance_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_465">465</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_variance_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_683">683</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_466">466</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_684">684</td><td nowrap="nowrap">&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_467">467</td><td nowrap="nowrap">&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_685">685</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_468">468</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_686">686</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Computes&nbsp;the&nbsp;R&nbsp;matrix&nbsp;inverses,&nbsp;and&nbsp;the&nbsp;gaussian&nbsp;constant</td><td class="diff_next"></td><td class="diff_header" id="to2_469">469</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Computes&nbsp;the&nbsp;R&nbsp;matrix&nbsp;inverses,&nbsp;and&nbsp;the&nbsp;gaussian&nbsp;constant</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_687">687</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_470">470</td><td nowrap="nowrap">&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_688">688</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_471">471</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_689">689</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_472">472</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_690">690</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;determinant_arg_acc_ct1(cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_473">473</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;determinant_arg_acc_ct1(cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_691">691</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_474">474</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_692">692</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_475">475</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_693">693</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum_acc_ct1(cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_476">476</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum_acc_ct1(cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_694">694</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_477">477</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_695">695</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_478">478</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_696">696</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix_acc_ct1(sycl::range&lt;1&gt;(576&nbsp;/*NUM_DIMENSIONS*NUM_DIMENSIONS*/),</td><td class="diff_next"></td><td class="diff_header" id="to2_479">479</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix_acc_ct1(sycl::range&lt;1&gt;(576&nbsp;/*NUM_DIMENSIONS*NUM_DIMENSIONS*/),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_697">697</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_480">480</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_698">698</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_481">481</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_699">699</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td><td class="diff_next"></td><td class="diff_header" id="to2_482">482</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_700">700</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;original_num_clusters)&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_483">483</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;original_num_clusters)&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_701">701</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP),</td><td class="diff_next"></td><td class="diff_header" id="to2_484">484</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_702">702</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP)),</td><td class="diff_next"></td><td class="diff_header" id="to2_485">485</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP)),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_703">703</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_486">486</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_704">704</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants_kernel(d_clusters,&nbsp;original_num_clusters,&nbsp;num_dimensions,</td><td class="diff_next"></td><td class="diff_header" id="to2_487">487</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants_kernel(d_clusters,&nbsp;original_num_clusters,&nbsp;num_dimensions,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_705">705</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_ct1,&nbsp;determinant_arg_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_488">488</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_ct1,&nbsp;determinant_arg_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_706">706</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_489">489</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_707">707</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_490">490</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_708">708</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_491">491</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_709">709</td><td nowrap="nowrap">&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_492">492</td><td nowrap="nowrap">&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_710">710</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_493">493</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_711">711</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;copy&nbsp;clusters&nbsp;from&nbsp;the&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_494">494</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;copy&nbsp;clusters&nbsp;from&nbsp;the&nbsp;device</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_712">712</td><td nowrap="nowrap">&nbsp;&nbsp;copyClusterFromDevice(&amp;clusters,&nbsp;&amp;temp_clusters,&nbsp;d_clusters,&nbsp;original_num_clusters,&nbsp;num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_495">495</td><td nowrap="nowrap">&nbsp;&nbsp;copyClusterFromDevice(&amp;clusters,&nbsp;&amp;temp_clusters,&nbsp;d_clusters,&nbsp;original_num_clusters,&nbsp;num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_713">713</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_496">496</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_714">714</td><td nowrap="nowrap">&nbsp;&nbsp;//seed_clusters(&amp;clusters,fcs_data_by_event,original_num_clusters,num_dimensions,num_events);</td><td class="diff_next"></td><td class="diff_header" id="to2_497">497</td><td nowrap="nowrap">&nbsp;&nbsp;//seed_clusters(&amp;clusters,fcs_data_by_event,original_num_clusters,num_dimensions,num_events);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_715">715</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_498">498</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_716">716</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Starting&nbsp;Clusters\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_499">499</td><td nowrap="nowrap">&nbsp;&nbsp;DEBUG("Starting&nbsp;Clusters\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_717">717</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;original_num_clusters;&nbsp;c++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_500">500</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;original_num_clusters;&nbsp;c++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_718">718</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Cluster&nbsp;#%d\n",c);</td><td class="diff_next"></td><td class="diff_header" id="to2_501">501</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Cluster&nbsp;#%d\n",c);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_719">719</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_502">502</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_720">720</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tN:&nbsp;%f\n",clusters.N[c]);</td><td class="diff_next"></td><td class="diff_header" id="to2_503">503</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tN:&nbsp;%f\n",clusters.N[c]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_721">721</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tpi:&nbsp;%f\n",clusters.pi[c]);</td><td class="diff_next"></td><td class="diff_header" id="to2_504">504</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tpi:&nbsp;%f\n",clusters.pi[c]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_722">722</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_505">505</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_723">723</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;means</td><td class="diff_next"></td><td class="diff_header" id="to2_506">506</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;means</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_724">724</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tMeans:&nbsp;");</td><td class="diff_next"></td><td class="diff_header" id="to2_507">507</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tMeans:&nbsp;");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_725">725</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_508">508</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_726">726</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("%.2f&nbsp;",clusters.means[c*num_dimensions+d]);</td><td class="diff_next"></td><td class="diff_header" id="to2_509">509</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("%.2f&nbsp;",clusters.means[c*num_dimensions+d]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_727">727</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_510">510</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_728">728</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_511">511</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_729">729</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_512">512</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_730">730</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tR:\n\t");</td><td class="diff_next"></td><td class="diff_header" id="to2_513">513</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tR:\n\t");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_731">731</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_514">514</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_732">732</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;e=0;&nbsp;e&nbsp;&lt;&nbsp;num_dimensions;&nbsp;e++)</td><td class="diff_next"></td><td class="diff_header" id="to2_515">515</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;e=0;&nbsp;e&nbsp;&lt;&nbsp;num_dimensions;&nbsp;e++)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_733">733</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("%.2f&nbsp;",clusters.R[c*num_dimensions*num_dimensions+d*num_dimensions+e]);</td><td class="diff_next"></td><td class="diff_header" id="to2_516">516</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("%.2f&nbsp;",clusters.R[c*num_dimensions*num_dimensions+d*num_dimensions+e]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_734">734</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n\t");</td><td class="diff_next"></td><td class="diff_header" id="to2_517">517</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n\t");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_735">735</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_518">518</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_736">736</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("R-inverse:\n\t");</td><td class="diff_next"></td><td class="diff_header" id="to2_519">519</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("R-inverse:\n\t");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_737">737</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_520">520</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_738">738</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;e=0;&nbsp;e&nbsp;&lt;&nbsp;num_dimensions;&nbsp;e++)</td><td class="diff_next"></td><td class="diff_header" id="to2_521">521</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;e=0;&nbsp;e&nbsp;&lt;&nbsp;num_dimensions;&nbsp;e++)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_739">739</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("%.2f&nbsp;",clusters.Rinv[c*num_dimensions*num_dimensions+d*num_dimensions+e]);</td><td class="diff_next"></td><td class="diff_header" id="to2_522">522</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("%.2f&nbsp;",clusters.Rinv[c*num_dimensions*num_dimensions+d*num_dimensions+e]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_740">740</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n\t");</td><td class="diff_next"></td><td class="diff_header" id="to2_523">523</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n\t");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_741">741</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_524">524</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_742">742</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_525">525</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_743">743</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tAvgvar:&nbsp;%e\n",clusters.avgvar[c]);</td><td class="diff_next"></td><td class="diff_header" id="to2_526">526</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tAvgvar:&nbsp;%e\n",clusters.avgvar[c]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_744">744</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tConstant:&nbsp;%e\n",clusters.constant[c]);</td><td class="diff_next"></td><td class="diff_header" id="to2_527">527</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\tConstant:&nbsp;%e\n",clusters.constant[c]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_745">745</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_528">528</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_746">746</td><td nowrap="nowrap">&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_529">529</td><td nowrap="nowrap">&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_747">747</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_530">530</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_748">748</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;synchronize&nbsp;after&nbsp;first&nbsp;gpu&nbsp;does&nbsp;the&nbsp;seeding,&nbsp;copy&nbsp;result&nbsp;to&nbsp;all&nbsp;gpus</td><td class="diff_next"></td><td class="diff_header" id="to2_531">531</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;synchronize&nbsp;after&nbsp;first&nbsp;gpu&nbsp;does&nbsp;the&nbsp;seeding,&nbsp;copy&nbsp;result&nbsp;to&nbsp;all&nbsp;gpus</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_749">749</td><td nowrap="nowrap">&nbsp;&nbsp;copyClusterToDevice(&amp;clusters,&nbsp;&amp;temp_clusters,&nbsp;original_num_clusters,&nbsp;num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_532">532</td><td nowrap="nowrap">&nbsp;&nbsp;copyClusterToDevice(&amp;clusters,&nbsp;&amp;temp_clusters,&nbsp;original_num_clusters,&nbsp;num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_750">750</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_533">533</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_751">751</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Calculate&nbsp;an&nbsp;epsilon&nbsp;value</td><td class="diff_next"></td><td class="diff_header" id="to2_534">534</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Calculate&nbsp;an&nbsp;epsilon&nbsp;value</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_752">752</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;epsilon&nbsp;=&nbsp;(1+num_dimensions+0.5f*(num_dimensions+1)*num_dimensions)*</td><td class="diff_next"></td><td class="diff_header" id="to2_535">535</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;epsilon&nbsp;=&nbsp;(1+num_dimensions+0.5f*(num_dimensions+1)*num_dimensions)*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_753">753</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;::logf((float)num_events*num_dimensions)*0.001f;</td><td class="diff_next"></td><td class="diff_header" id="to2_536">536</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;::logf((float)num_events*num_dimensions)*0.001f;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_754">754</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;iters;</td><td class="diff_next"></td><td class="diff_header" id="to2_537">537</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;iters;</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__8"></td><td class="diff_header" id="from2_755">755</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_538">538</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_756">756</td><td nowrap="nowrap">&nbsp;&nbsp;//epsilon&nbsp;=&nbsp;1e-6;</td><td class="diff_next"></td><td class="diff_header" id="to2_539">539</td><td nowrap="nowrap">&nbsp;&nbsp;//epsilon&nbsp;=&nbsp;1e-6;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_757">757</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("Gaussian.cu:&nbsp;epsilon&nbsp;=&nbsp;%f\n",epsilon);</td><td class="diff_next"></td><td class="diff_header" id="to2_540">540</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("Gaussian.cu:&nbsp;epsilon&nbsp;=&nbsp;%f\n",epsilon);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_758">758</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_541">541</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_759">759</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;d_likelihoods;</td><td class="diff_next"></td><td class="diff_header" id="to2_542">542</td><td nowrap="nowrap">&nbsp;&nbsp;float*&nbsp;d_likelihoods;</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__9">n</a></td><td class="diff_header" id="from2_760">760</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__9">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_761">761</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:66:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_762">762</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_763">763</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_764">764</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;CUDA_SAFE_CALL(</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_765">765</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;(</span>d_likelihoods&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(NUM_BLOCKS,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_543">543</td><td nowrap="nowrap">&nbsp;&nbsp;d_likelihoods&nbsp;=&nbsp;sycl::malloc_device&lt;float&gt;(NUM_BLOCKS,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_766">766</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_544">544</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_767">767</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Variables&nbsp;for&nbsp;GMM&nbsp;reduce&nbsp;order</td><td class="diff_next"></td><td class="diff_header" id="to2_545">545</td><td nowrap="nowrap">&nbsp;&nbsp;//&nbsp;Variables&nbsp;for&nbsp;GMM&nbsp;reduce&nbsp;order</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_768">768</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;distance,&nbsp;min_distance&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_546">546</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;distance,&nbsp;min_distance&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_769">769</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;rissanen;</td><td class="diff_next"></td><td class="diff_header" id="to2_547">547</td><td nowrap="nowrap">&nbsp;&nbsp;float&nbsp;rissanen;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_770">770</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;min_c1,&nbsp;min_c2;</td><td class="diff_next"></td><td class="diff_header" id="to2_548">548</td><td nowrap="nowrap">&nbsp;&nbsp;int&nbsp;min_c1,&nbsp;min_c2;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_771">771</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_549">549</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_772">772</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;num_clusters=original_num_clusters;&nbsp;num_clusters&nbsp;&gt;=&nbsp;stop_number;&nbsp;num_clusters--)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_550">550</td><td nowrap="nowrap">&nbsp;&nbsp;for(int&nbsp;num_clusters=original_num_clusters;&nbsp;num_clusters&nbsp;&gt;=&nbsp;stop_number;&nbsp;num_clusters--)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_773">773</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;/***************&nbsp;EM&nbsp;ALGORITHM&nbsp;*****************************/</td><td class="diff_next"></td><td class="diff_header" id="to2_551">551</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;/***************&nbsp;EM&nbsp;ALGORITHM&nbsp;*****************************/</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_774">774</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_552">552</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_775">775</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;do&nbsp;initial&nbsp;E-step</td><td class="diff_next"></td><td class="diff_header" id="to2_553">553</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;do&nbsp;initial&nbsp;E-step</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_776">776</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Calculates&nbsp;a&nbsp;cluster&nbsp;membership&nbsp;probability</td><td class="diff_next"></td><td class="diff_header" id="to2_554">554</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Calculates&nbsp;a&nbsp;cluster&nbsp;membership&nbsp;probability</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_777">777</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;for&nbsp;each&nbsp;event&nbsp;and&nbsp;each&nbsp;cluster.</td><td class="diff_next"></td><td class="diff_header" id="to2_555">555</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;for&nbsp;each&nbsp;event&nbsp;and&nbsp;each&nbsp;cluster.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_778">778</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Invoking&nbsp;E-step&nbsp;kernels.");</td><td class="diff_next"></td><td class="diff_header" id="to2_556">556</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Invoking&nbsp;E-step&nbsp;kernels.");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_779">779</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_557">557</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_780">780</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_558">558</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_781">781</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_559">559</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_782">782</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_acc_ct1(sycl::range&lt;1&gt;(24&nbsp;/*NUM_DIMENSIONS*/),&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_560">560</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_acc_ct1(sycl::range&lt;1&gt;(24&nbsp;/*NUM_DIMENSIONS*/),&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_783">783</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_561">561</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_784">784</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_562">562</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_785">785</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rinv_acc_ct1(sycl::range&lt;1&gt;(576&nbsp;/*NUM_DIMENSIONS*NUM_DIMENSIONS*/),</td><td class="diff_next"></td><td class="diff_header" id="to2_563">563</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rinv_acc_ct1(sycl::range&lt;1&gt;(576&nbsp;/*NUM_DIMENSIONS*NUM_DIMENSIONS*/),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_786">786</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_564">564</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_787">787</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_565">565</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_788">788</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td><td class="diff_next"></td><td class="diff_header" id="to2_566">566</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_789">789</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;NUM_BLOCKS,&nbsp;num_clusters)&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_567">567</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;NUM_BLOCKS,&nbsp;num_clusters)&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_790">790</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP),</td><td class="diff_next"></td><td class="diff_header" id="to2_568">568</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_791">791</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP)),</td><td class="diff_next"></td><td class="diff_header" id="to2_569">569</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP)),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_792">792</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_570">570</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_793">793</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estep1(d_fcs_data_by_dimension,&nbsp;d_clusters,&nbsp;num_dimensions,</td><td class="diff_next"></td><td class="diff_header" id="to2_571">571</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estep1(d_fcs_data_by_dimension,&nbsp;d_clusters,&nbsp;num_dimensions,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_794">794</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_events,&nbsp;item_ct1,&nbsp;means_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_572">572</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_events,&nbsp;item_ct1,&nbsp;means_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_795">795</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rinv_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_573">573</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rinv_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_796">796</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_574">574</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_797">797</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_575">575</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_798">798</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_576">576</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_799">799</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_577">577</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_800">800</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_578">578</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_801">801</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_likelihoods_acc_ct1(sycl::range&lt;1&gt;(256&nbsp;/*NUM_THREADS_ESTEP*/),</td><td class="diff_next"></td><td class="diff_header" id="to2_579">579</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_likelihoods_acc_ct1(sycl::range&lt;1&gt;(256&nbsp;/*NUM_THREADS_ESTEP*/),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_802">802</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_580">580</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_803">803</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_581">581</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_804">804</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td><td class="diff_next"></td><td class="diff_header" id="to2_582">582</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_805">805</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_BLOCKS)&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_583">583</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_BLOCKS)&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_806">806</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP),</td><td class="diff_next"></td><td class="diff_header" id="to2_584">584</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_807">807</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP)),</td><td class="diff_next"></td><td class="diff_header" id="to2_585">585</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP)),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_808">808</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_586">586</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_809">809</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estep2(d_fcs_data_by_dimension,&nbsp;d_clusters,&nbsp;num_dimensions,</td><td class="diff_next"></td><td class="diff_header" id="to2_587">587</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estep2(d_fcs_data_by_dimension,&nbsp;d_clusters,&nbsp;num_dimensions,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_810">810</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters,&nbsp;num_events,&nbsp;d_likelihoods,&nbsp;item_ct1,</td><td class="diff_next"></td><td class="diff_header" id="to2_588">588</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters,&nbsp;num_events,&nbsp;d_likelihoods,&nbsp;item_ct1,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_811">811</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_likelihoods_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_589">589</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_likelihoods_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__9"></td><td class="diff_header" id="from2_812">812</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_590">590</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_813">813</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_591">591</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_814">814</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;regroup_iterations++;</td><td class="diff_next"></td><td class="diff_header" id="to2_592">592</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;regroup_iterations++;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_815">815</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_593">593</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_816">816</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Copy&nbsp;the&nbsp;likelihood&nbsp;totals&nbsp;from&nbsp;each&nbsp;block,&nbsp;sum&nbsp;them&nbsp;up&nbsp;to&nbsp;get&nbsp;a&nbsp;total</td><td class="diff_next"></td><td class="diff_header" id="to2_594">594</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Copy&nbsp;the&nbsp;likelihood&nbsp;totals&nbsp;from&nbsp;each&nbsp;block,&nbsp;sum&nbsp;them&nbsp;up&nbsp;to&nbsp;get&nbsp;a&nbsp;total</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__10">n</a></td><td class="diff_header" id="from2_817">817</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__10">n</a></td><td class="diff_header" id="to2_595">595</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(shared_likelihoods,&nbsp;d_likelihoods,sizeof(float)&nbsp;*&nbsp;NUM_BLOCKS).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_818">818</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:67:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_819">819</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_820">820</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_821">821</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_822">822</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(shared_likelihoods,&nbsp;d_likelihoods,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_823">823</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;NUM_BLOCKS)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_824">824</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_825">825</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_826">826</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_596">596</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_827">827</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;i&lt;NUM_BLOCKS;i++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_597">597</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;i&lt;NUM_BLOCKS;i++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_828">828</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;+=&nbsp;shared_likelihoods[i];&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_598">598</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;+=&nbsp;shared_likelihoods[i];&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_829">829</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_599">599</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_830">830</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Likelihood:&nbsp;%e\n",likelihood);</td><td class="diff_next"></td><td class="diff_header" id="to2_600">600</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Likelihood:&nbsp;%e\n",likelihood);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_831">831</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_601">601</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_832">832</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;change&nbsp;=&nbsp;epsilon*2;</td><td class="diff_next"></td><td class="diff_header" id="to2_602">602</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;float&nbsp;change&nbsp;=&nbsp;epsilon*2;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_833">833</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_603">603</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_834">834</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;PRINT("Performing&nbsp;EM&nbsp;algorithm&nbsp;on&nbsp;%d&nbsp;clusters.\n",num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_604">604</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;PRINT("Performing&nbsp;EM&nbsp;algorithm&nbsp;on&nbsp;%d&nbsp;clusters.\n",num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_835">835</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;iters&nbsp;=&nbsp;0;</td><td class="diff_next"></td><td class="diff_header" id="to2_605">605</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;iters&nbsp;=&nbsp;0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_836">836</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;is&nbsp;the&nbsp;iterative&nbsp;loop&nbsp;for&nbsp;the&nbsp;EM&nbsp;algorithm.</td><td class="diff_next"></td><td class="diff_header" id="to2_606">606</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;is&nbsp;the&nbsp;iterative&nbsp;loop&nbsp;for&nbsp;the&nbsp;EM&nbsp;algorithm.</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_837">837</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;It&nbsp;re-estimates&nbsp;parameters,&nbsp;re-computes&nbsp;constants,&nbsp;and&nbsp;then&nbsp;regroups&nbsp;the&nbsp;events</td><td class="diff_next"></td><td class="diff_header" id="to2_607">607</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;It&nbsp;re-estimates&nbsp;parameters,&nbsp;re-computes&nbsp;constants,&nbsp;and&nbsp;then&nbsp;regroups&nbsp;the&nbsp;events</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_838">838</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;These&nbsp;steps&nbsp;keep&nbsp;repeating&nbsp;until&nbsp;the&nbsp;change&nbsp;in&nbsp;likelihood&nbsp;is&nbsp;less&nbsp;than&nbsp;some&nbsp;epsilon</td><td class="diff_next"></td><td class="diff_header" id="to2_608">608</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;These&nbsp;steps&nbsp;keep&nbsp;repeating&nbsp;until&nbsp;the&nbsp;change&nbsp;in&nbsp;likelihood&nbsp;is&nbsp;less&nbsp;than&nbsp;some&nbsp;epsilon</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_839">839</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;while(iters&nbsp;&lt;&nbsp;MIN_ITERS&nbsp;||&nbsp;(fabs(change)&nbsp;&gt;&nbsp;epsilon&nbsp;&amp;&amp;&nbsp;iters&nbsp;&lt;&nbsp;MAX_ITERS))&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_609">609</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;while(iters&nbsp;&lt;&nbsp;MIN_ITERS&nbsp;||&nbsp;(fabs(change)&nbsp;&gt;&nbsp;epsilon&nbsp;&amp;&amp;&nbsp;iters&nbsp;&lt;&nbsp;MAX_ITERS))&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_840">840</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old_likelihood&nbsp;=&nbsp;likelihood;</td><td class="diff_next"></td><td class="diff_header" id="to2_610">610</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;old_likelihood&nbsp;=&nbsp;likelihood;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_841">841</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_611">611</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_842">842</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Invoking&nbsp;reestimate_parameters&nbsp;(M-step)&nbsp;kernel.");</td><td class="diff_next"></td><td class="diff_header" id="to2_612">612</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Invoking&nbsp;reestimate_parameters&nbsp;(M-step)&nbsp;kernel.");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_843">843</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_613">613</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_844">844</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;kernel&nbsp;computes&nbsp;a&nbsp;new&nbsp;N,&nbsp;pi&nbsp;isn't&nbsp;updated&nbsp;until&nbsp;compute_constants&nbsp;though</td><td class="diff_next"></td><td class="diff_header" id="to2_614">614</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;This&nbsp;kernel&nbsp;computes&nbsp;a&nbsp;new&nbsp;N,&nbsp;pi&nbsp;isn't&nbsp;updated&nbsp;until&nbsp;compute_constants&nbsp;though</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_845">845</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_615">615</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_846">846</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_616">616</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_847">847</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_617">617</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_848">848</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sums_acc_ct1(sycl::range&lt;1&gt;(256&nbsp;/*NUM_THREADS_MSTEP*/),&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_618">618</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sums_acc_ct1(sycl::range&lt;1&gt;(256&nbsp;/*NUM_THREADS_MSTEP*/),&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_849">849</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_619">619</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_850">850</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td><td class="diff_next"></td><td class="diff_header" id="to2_620">620</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_851">851</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;num_clusters)&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_621">621</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;num_clusters)&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_852">852</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP),</td><td class="diff_next"></td><td class="diff_header" id="to2_622">622</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_853">853</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP)),</td><td class="diff_next"></td><td class="diff_header" id="to2_623">623</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP)),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_854">854</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_624">624</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__10"></td><td class="diff_header" id="from2_855">855</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mstep_N(d_clusters,&nbsp;num_dimensions,&nbsp;num_clusters,&nbsp;num_events,</td><td class="diff_next"></td><td class="diff_header" id="to2_625">625</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mstep_N(d_clusters,&nbsp;num_dimensions,&nbsp;num_clusters,&nbsp;num_events,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_856">856</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_ct1,&nbsp;temp_sums_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_626">626</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_ct1,&nbsp;temp_sums_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_857">857</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_627">627</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_858">858</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_628">628</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_859">859</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_629">629</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__11">n</a></td><td class="diff_header" id="from2_860">860</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__11">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_861">861</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:70:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_862">862</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_863">863</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_864">864</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_865">865</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_866">866</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_chg">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>.memcpy(clusters.N,&nbsp;temp_clusters.N,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)</td><td class="diff_next"></td><td class="diff_header" id="to2_630">630</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="diff_chg">q_ct1</span>.memcpy(clusters.N,&nbsp;temp_clusters.N,&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)<span class="diff_add">.wait();</span></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__11"></td><td class="diff_header" id="from2_867">867</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_868">868</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_869">869</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_631">631</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_870">870</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;&nbsp;gridDim1(1,&nbsp;num_dimensions,&nbsp;num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_632">632</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;&nbsp;gridDim1(1,&nbsp;num_dimensions,&nbsp;num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_871">871</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;&nbsp;blockDim1(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP);</td><td class="diff_next"></td><td class="diff_header" id="to2_633">633</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;&nbsp;blockDim1(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP);</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__12">n</a></td><td class="diff_header" id="from2_872">872</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__12">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_873">873</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1049:68:&nbsp;The&nbsp;workgroup&nbsp;size&nbsp;passed&nbsp;to&nbsp;the&nbsp;SYCL&nbsp;kernel&nbsp;may&nbsp;exceed&nbsp;the</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_874">874</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit.&nbsp;To&nbsp;get&nbsp;the&nbsp;device&nbsp;limit,&nbsp;query&nbsp;info::device::max_work_group_size.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_875">875</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adjust&nbsp;the&nbsp;workgroup&nbsp;size&nbsp;if&nbsp;needed.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_876">876</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__12"></td><td class="diff_header" id="from2_877">877</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_634">634</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_878">878</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_635">635</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_879">879</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_636">636</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_880">880</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sum_acc_ct1(sycl::range&lt;1&gt;(256&nbsp;/*NUM_THREADS_MSTEP*/),&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_637">637</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sum_acc_ct1(sycl::range&lt;1&gt;(256&nbsp;/*NUM_THREADS_MSTEP*/),&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_881">881</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_638">638</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__13">n</a></td><td class="diff_header" id="from2_882">882</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(sycl::nd_range&lt;3&gt;(gridDim1&nbsp;*&nbsp;blockDim1,&nbsp;blockDim1),</span></td><td class="diff_next"><a href="#difflib_chg_to2__13">n</a></td><td class="diff_header" id="to2_639">639</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;dpct_global_range&nbsp;=&nbsp;gridDim1&nbsp;*&nbsp;blockDim1;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_640">640</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_641">641</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(sycl::nd_range&lt;3&gt;(</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_642">642</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(dpct_global_range.get(2),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_643">643</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dpct_global_range.get(1),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_644">644</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dpct_global_range.get(0)),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_645">645</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(blockDim1.get(2),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_646">646</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blockDim1.get(1),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_647">647</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blockDim1.get(0))),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_883">883</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_648">648</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_884">884</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mstep_means(d_fcs_data_by_dimension,&nbsp;d_clusters,</td><td class="diff_next"></td><td class="diff_header" id="to2_649">649</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mstep_means(d_fcs_data_by_dimension,&nbsp;d_clusters,</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__13"></td><td class="diff_header" id="from2_885">885</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_dimensions,&nbsp;num_clusters,&nbsp;num_events,</td><td class="diff_next"></td><td class="diff_header" id="to2_650">650</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_dimensions,&nbsp;num_clusters,&nbsp;num_events,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_886">886</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_ct1,</td><td class="diff_next"></td><td class="diff_header" id="to2_651">651</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_ct1,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_887">887</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sum_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_652">652</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sum_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_888">888</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_653">653</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_889">889</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_654">654</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__14">n</a></td><td class="diff_header" id="from2_890">890</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__14">n</a></td><td class="diff_header" id="to2_655">655</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(clusters.means,&nbsp;temp_clusters.means,sizeof(float)&nbsp;*&nbsp;num_clusters&nbsp;*&nbsp;num_dimensions).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_891">891</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:71:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_892">892</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_893">893</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_894">894</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_895">895</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(clusters.means,&nbsp;temp_clusters.means,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_896">896</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters&nbsp;*&nbsp;num_dimensions)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_897">897</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_898">898</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_899">899</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_656">656</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_900">900</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Reduce&nbsp;means&nbsp;for&nbsp;all&nbsp;clusters,&nbsp;copy&nbsp;back&nbsp;to&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_657">657</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Reduce&nbsp;means&nbsp;for&nbsp;all&nbsp;clusters,&nbsp;copy&nbsp;back&nbsp;to&nbsp;device</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_901">901</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;num_clusters;&nbsp;c++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_658">658</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;num_clusters;&nbsp;c++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_902">902</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Cluster&nbsp;%d&nbsp;&nbsp;Means:",&nbsp;c);</td><td class="diff_next"></td><td class="diff_header" id="to2_659">659</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Cluster&nbsp;%d&nbsp;&nbsp;Means:",&nbsp;c);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_903">903</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_660">660</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_904">904</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(clusters.N[c]&nbsp;&gt;&nbsp;0.5f)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_661">661</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(clusters.N[c]&nbsp;&gt;&nbsp;0.5f)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_905">905</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.means[c*num_dimensions+d]&nbsp;/=&nbsp;clusters.N[c];</td><td class="diff_next"></td><td class="diff_header" id="to2_662">662</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.means[c*num_dimensions+d]&nbsp;/=&nbsp;clusters.N[c];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_906">906</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_663">663</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_907">907</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.means[c*num_dimensions+d]&nbsp;=&nbsp;0.0f;</td><td class="diff_next"></td><td class="diff_header" id="to2_664">664</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.means[c*num_dimensions+d]&nbsp;=&nbsp;0.0f;</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__14"></td><td class="diff_header" id="from2_908">908</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_665">665</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_909">909</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("&nbsp;%f",clusters.means[c*num_dimensions+d]);</td><td class="diff_next"></td><td class="diff_header" id="to2_666">666</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("&nbsp;%f",clusters.means[c*num_dimensions+d]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_910">910</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_667">667</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_911">911</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_668">668</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_912">912</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_669">669</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__15">n</a></td><td class="diff_header" id="from2_913">913</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__15">n</a></td><td class="diff_header" id="to2_670">670</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(temp_clusters.means,&nbsp;clusters.means,sizeof(float)&nbsp;*&nbsp;num_clusters&nbsp;*&nbsp;num_dimensions).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_914">914</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:72:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_915">915</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_916">916</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_917">917</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_918">918</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(temp_clusters.means,&nbsp;clusters.means,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_919">919</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters&nbsp;*&nbsp;num_dimensions)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_920">920</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_921">921</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__15"></td><td class="diff_header" id="from2_922">922</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_671">671</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_923">923</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Covariance&nbsp;is&nbsp;symmetric,&nbsp;so&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;compute&nbsp;N*(N+1)/2&nbsp;matrix&nbsp;elements&nbsp;per&nbsp;cluster</td><td class="diff_next"></td><td class="diff_header" id="to2_672">672</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Covariance&nbsp;is&nbsp;symmetric,&nbsp;so&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;compute&nbsp;N*(N+1)/2&nbsp;matrix&nbsp;elements&nbsp;per&nbsp;cluster</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_924">924</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;&nbsp;gridDim2(1,&nbsp;num_dimensions&nbsp;*&nbsp;(num_dimensions&nbsp;+&nbsp;1)&nbsp;/&nbsp;2,</td><td class="diff_next"></td><td class="diff_header" id="to2_673">673</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;&nbsp;gridDim2(1,&nbsp;num_dimensions&nbsp;*&nbsp;(num_dimensions&nbsp;+&nbsp;1)&nbsp;/&nbsp;2,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_925">925</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(num_clusters&nbsp;+&nbsp;NUM_CLUSTERS_PER_BLOCK&nbsp;-&nbsp;1)&nbsp;/</td><td class="diff_next"></td><td class="diff_header" id="to2_674">674</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(num_clusters&nbsp;+&nbsp;NUM_CLUSTERS_PER_BLOCK&nbsp;-&nbsp;1)&nbsp;/</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_926">926</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUM_CLUSTERS_PER_BLOCK);</td><td class="diff_next"></td><td class="diff_header" id="to2_675">675</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUM_CLUSTERS_PER_BLOCK);</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__16">n</a></td><td class="diff_header" id="from2_927">927</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__16">n</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_928">928</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1049:69:&nbsp;The&nbsp;workgroup&nbsp;size&nbsp;passed&nbsp;to&nbsp;the&nbsp;SYCL&nbsp;kernel&nbsp;may&nbsp;exceed&nbsp;the</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_929">929</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;limit.&nbsp;To&nbsp;get&nbsp;the&nbsp;device&nbsp;limit,&nbsp;query&nbsp;info::device::max_work_group_size.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_930">930</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Adjust&nbsp;the&nbsp;workgroup&nbsp;size&nbsp;if&nbsp;needed.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_931">931</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_932">932</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_676">676</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_933">933</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_677">677</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_934">934</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_678">678</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_935">935</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_row_acc_ct1(sycl::range&lt;1&gt;(6&nbsp;/*NUM_CLUSTERS_PER_BLOCK*/),</td><td class="diff_next"></td><td class="diff_header" id="to2_679">679</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_row_acc_ct1(sycl::range&lt;1&gt;(6&nbsp;/*NUM_CLUSTERS_PER_BLOCK*/),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_936">936</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_680">680</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_937">937</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_681">681</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_938">938</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_682">682</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_939">939</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_col_acc_ct1(sycl::range&lt;1&gt;(6&nbsp;/*NUM_CLUSTERS_PER_BLOCK*/),</td><td class="diff_next"></td><td class="diff_header" id="to2_683">683</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_col_acc_ct1(sycl::range&lt;1&gt;(6&nbsp;/*NUM_CLUSTERS_PER_BLOCK*/),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_940">940</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_684">684</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_941">941</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_685">685</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_942">942</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_686">686</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__16"></td><td class="diff_header" id="from2_943">943</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sums_acc_ct1(</td><td class="diff_next"></td><td class="diff_header" id="to2_687">687</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sums_acc_ct1(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_944">944</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;1&gt;(</td><td class="diff_next"></td><td class="diff_header" id="to2_688">688</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;1&gt;(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_945">945</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1536&nbsp;/*NUM_THREADS_MSTEP*NUM_CLUSTERS_PER_BLOCK*/),</td><td class="diff_next"></td><td class="diff_header" id="to2_689">689</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1536&nbsp;/*NUM_THREADS_MSTEP*NUM_CLUSTERS_PER_BLOCK*/),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_946">946</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_690">690</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_947">947</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_691">691</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__17">n</a></td><td class="diff_header" id="from2_948">948</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(sycl::nd_range&lt;3&gt;(gridDim2&nbsp;*&nbsp;blockDim1,&nbsp;blockDim1),</span></td><td class="diff_next"><a href="#difflib_chg_to2__17">n</a></td><td class="diff_header" id="to2_692">692</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;auto&nbsp;dpct_global_range&nbsp;=&nbsp;gridDim2&nbsp;*&nbsp;blockDim1;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_693">693</td><td nowrap="nowrap"><span class="diff_add">&nbsp;</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_694">694</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(sycl::nd_range&lt;3&gt;(</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_695">695</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(dpct_global_range.get(2),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_696">696</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dpct_global_range.get(1),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_697">697</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dpct_global_range.get(0)),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_698">698</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(blockDim1.get(2),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_699">699</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blockDim1.get(1),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_700">700</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blockDim1.get(0))),</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_949">949</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_701">701</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_950">950</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mstep_covariance2(d_fcs_data_by_dimension,</td><td class="diff_next"></td><td class="diff_header" id="to2_702">702</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mstep_covariance2(d_fcs_data_by_dimension,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_951">951</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d_clusters,&nbsp;num_dimensions,</td><td class="diff_next"></td><td class="diff_header" id="to2_703">703</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d_clusters,&nbsp;num_dimensions,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_952">952</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters,&nbsp;num_events,&nbsp;item_ct1,</td><td class="diff_next"></td><td class="diff_header" id="to2_704">704</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters,&nbsp;num_events,&nbsp;item_ct1,</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__17"></td><td class="diff_header" id="from2_953">953</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_row_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_705">705</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_row_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_954">954</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_col_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_706">706</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_col_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_955">955</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sums_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_707">707</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temp_sums_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_956">956</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_708">708</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_957">957</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_709">709</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__18">n</a></td><td class="diff_header" id="from2_958">958</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__18">n</a></td><td class="diff_header" id="to2_710">710</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(clusters.R,&nbsp;temp_clusters.R,sizeof(float)&nbsp;*&nbsp;num_clusters&nbsp;*num_dimensions&nbsp;*&nbsp;num_dimensions).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_959">959</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:73:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_960">960</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_961">961</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_962">962</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_963">963</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(clusters.R,&nbsp;temp_clusters.R,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_964">964</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters&nbsp;*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_965">965</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_966">966</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_967">967</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_968">968</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_711">711</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_969">969</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("After&nbsp;cov2\tR:\n\t");</td><td class="diff_next"></td><td class="diff_header" id="to2_712">712</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("After&nbsp;cov2\tR:\n\t");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_970">970</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;num_clusters;&nbsp;c++)&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_713">713</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;num_clusters;&nbsp;c++)&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_971">971</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_714">714</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions;&nbsp;d++)&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_972">972</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;e=0;&nbsp;e&nbsp;&lt;&nbsp;num_dimensions;&nbsp;e++)</td><td class="diff_next"></td><td class="diff_header" id="to2_715">715</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;e=0;&nbsp;e&nbsp;&lt;&nbsp;num_dimensions;&nbsp;e++)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_973">973</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("%.2f&nbsp;",clusters.R[c*num_dimensions*num_dimensions+d*num_dimensions+e]);</td><td class="diff_next"></td><td class="diff_header" id="to2_716">716</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("%.2f&nbsp;",clusters.R[c*num_dimensions*num_dimensions+d*num_dimensions+e]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_974">974</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_717">717</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_975">975</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_718">718</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_976">976</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Reduce&nbsp;R&nbsp;for&nbsp;all&nbsp;clusters,&nbsp;copy&nbsp;back&nbsp;to&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_719">719</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Reduce&nbsp;R&nbsp;for&nbsp;all&nbsp;clusters,&nbsp;copy&nbsp;back&nbsp;to&nbsp;device</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_977">977</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_720">720</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_978">978</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;num_clusters;&nbsp;c++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_721">721</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c=0;&nbsp;c&nbsp;&lt;&nbsp;num_clusters;&nbsp;c++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_979">979</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(clusters.N[c]&nbsp;&gt;&nbsp;0.5f)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_722">722</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(clusters.N[c]&nbsp;&gt;&nbsp;0.5f)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_980">980</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions*num_dimensions;&nbsp;d++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_723">723</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;d=0;&nbsp;d&nbsp;&lt;&nbsp;num_dimensions*num_dimensions;&nbsp;d++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_981">981</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.R[c*num_dimensions*num_dimensions+d]&nbsp;/=&nbsp;clusters.N[c];</td><td class="diff_next"></td><td class="diff_header" id="to2_724">724</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.R[c*num_dimensions*num_dimensions+d]&nbsp;/=&nbsp;clusters.N[c];</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_982">982</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_725">725</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_983">983</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_726">726</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_984">984</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&nbsp;&lt;&nbsp;num_dimensions;&nbsp;i++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_727">727</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;&nbsp;i&nbsp;&lt;&nbsp;num_dimensions;&nbsp;i++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_985">985</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=0;&nbsp;j&nbsp;&lt;&nbsp;num_dimensions;&nbsp;j++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_728">728</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=0;&nbsp;j&nbsp;&lt;&nbsp;num_dimensions;&nbsp;j++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_986">986</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(i&nbsp;==&nbsp;j)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_729">729</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(i&nbsp;==&nbsp;j)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_987">987</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.R[c*num_dimensions*num_dimensions+i*num_dimensions+j]&nbsp;=&nbsp;1.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_730">730</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.R[c*num_dimensions*num_dimensions+i*num_dimensions+j]&nbsp;=&nbsp;1.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_988">988</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_731">731</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_989">989</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.R[c*num_dimensions*num_dimensions+i*num_dimensions+j]&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_732">732</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;clusters.R[c*num_dimensions*num_dimensions+i*num_dimensions+j]&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_990">990</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_733">733</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__18"></td><td class="diff_header" id="from2_991">991</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_734">734</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_992">992</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_735">735</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_993">993</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_736">736</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_994">994</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_737">737</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_995">995</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_738">738</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__19">n</a></td><td class="diff_header" id="from2_996">996</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__19">n</a></td><td class="diff_header" id="to2_739">739</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(temp_clusters.R,&nbsp;clusters.R,sizeof(float)&nbsp;*&nbsp;num_clusters&nbsp;*num_dimensions&nbsp;*&nbsp;num_dimensions).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_997">997</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:74:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_998">998</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_999">999</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1000">1000</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1001">1001</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(temp_clusters.R,&nbsp;clusters.R,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1002">1002</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters&nbsp;*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1003">1003</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_dimensions&nbsp;*&nbsp;num_dimensions)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1004">1004</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1005">1005</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1006">1006</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_740">740</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1007">1007</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//CUT_CHECK_ERROR("M-step&nbsp;Kernel&nbsp;execution&nbsp;failed:&nbsp;");</td><td class="diff_next"></td><td class="diff_header" id="to2_741">741</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//CUT_CHECK_ERROR("M-step&nbsp;Kernel&nbsp;execution&nbsp;failed:&nbsp;");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1008">1008</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params_iterations++;</td><td class="diff_next"></td><td class="diff_header" id="to2_742">742</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params_iterations++;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1009">1009</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_743">743</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1010">1010</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Invoking&nbsp;constants&nbsp;kernel.");</td><td class="diff_next"></td><td class="diff_header" id="to2_744">744</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Invoking&nbsp;constants&nbsp;kernel.");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1011">1011</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_745">745</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1012">1012</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Inverts&nbsp;the&nbsp;R&nbsp;matrices,&nbsp;computes&nbsp;the&nbsp;constant,&nbsp;normalizes&nbsp;cluster&nbsp;probabilities</td><td class="diff_next"></td><td class="diff_header" id="to2_746">746</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Inverts&nbsp;the&nbsp;R&nbsp;matrices,&nbsp;computes&nbsp;the&nbsp;constant,&nbsp;normalizes&nbsp;cluster&nbsp;probabilities</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1013">1013</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_747">747</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1014">1014</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_748">748</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1015">1015</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_749">749</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1016">1016</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;determinant_arg_acc_ct1(cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_750">750</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;determinant_arg_acc_ct1(cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1017">1017</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_751">751</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;0,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1018">1018</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_752">752</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1019">1019</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum_acc_ct1(cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_753">753</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum_acc_ct1(cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1020">1020</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_754">754</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1021">1021</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_755">755</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1022">1022</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix_acc_ct1(</td><td class="diff_next"></td><td class="diff_header" id="to2_756">756</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix_acc_ct1(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1023">1023</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;1&gt;(576&nbsp;/*NUM_DIMENSIONS*NUM_DIMENSIONS*/),&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_757">757</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;1&gt;(576&nbsp;/*NUM_DIMENSIONS*NUM_DIMENSIONS*/),&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1024">1024</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_758">758</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1025">1025</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td><td class="diff_next"></td><td class="diff_header" id="to2_759">759</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1026">1026</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;num_clusters)&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_760">760</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;num_clusters)&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1027">1027</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP),</td><td class="diff_next"></td><td class="diff_header" id="to2_761">761</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1028">1028</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP)),</td><td class="diff_next"></td><td class="diff_header" id="to2_762">762</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_MSTEP)),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1029">1029</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_763">763</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1030">1030</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants_kernel(d_clusters,&nbsp;num_clusters,&nbsp;num_dimensions,</td><td class="diff_next"></td><td class="diff_header" id="to2_764">764</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constants_kernel(d_clusters,&nbsp;num_clusters,&nbsp;num_dimensions,</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__19"></td><td class="diff_header" id="from2_1031">1031</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_ct1,&nbsp;determinant_arg_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_765">765</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item_ct1,&nbsp;determinant_arg_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1032">1032</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_766">766</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sum_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1033">1033</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_767">767</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matrix_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1034">1034</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_768">768</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1035">1035</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_769">769</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__20">n</a></td><td class="diff_header" id="from2_1036">1036</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__20">n</a></td><td class="diff_header" id="to2_770">770</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(clusters.constant,&nbsp;temp_clusters.constant,sizeof(float)&nbsp;*&nbsp;num_clusters).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1037">1037</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:75:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1038">1038</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1039">1039</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1040">1040</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1041">1041</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(clusters.constant,&nbsp;temp_clusters.constant,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1042">1042</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_clusters)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1043">1043</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1044">1044</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1045">1045</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;temp_c=0;&nbsp;temp_c&nbsp;&lt;&nbsp;num_clusters;&nbsp;temp_c++)</td><td class="diff_next"></td><td class="diff_header" id="to2_771">771</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;temp_c=0;&nbsp;temp_c&nbsp;&lt;&nbsp;num_clusters;&nbsp;temp_c++)</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1046">1046</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Cluster&nbsp;%d&nbsp;constant:&nbsp;%e\n",temp_c,clusters.constant[temp_c]);</td><td class="diff_next"></td><td class="diff_header" id="to2_772">772</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Cluster&nbsp;%d&nbsp;constant:&nbsp;%e\n",temp_c,clusters.constant[temp_c]);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1047">1047</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_773">773</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1048">1048</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Invoking&nbsp;regroup&nbsp;(E-step)&nbsp;kernel&nbsp;with&nbsp;%d&nbsp;blocks.\n",NUM_BLOCKS);</td><td class="diff_next"></td><td class="diff_header" id="to2_774">774</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Invoking&nbsp;regroup&nbsp;(E-step)&nbsp;kernel&nbsp;with&nbsp;%d&nbsp;blocks.\n",NUM_BLOCKS);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1049">1049</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Compute&nbsp;new&nbsp;cluster&nbsp;membership&nbsp;probabilities&nbsp;for&nbsp;all&nbsp;the&nbsp;events</td><td class="diff_next"></td><td class="diff_header" id="to2_775">775</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Compute&nbsp;new&nbsp;cluster&nbsp;membership&nbsp;probabilities&nbsp;for&nbsp;all&nbsp;the&nbsp;events</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1050">1050</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_776">776</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1051">1051</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_777">777</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1052">1052</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_778">778</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1053">1053</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_acc_ct1(sycl::range&lt;1&gt;(24&nbsp;/*NUM_DIMENSIONS*/),&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_779">779</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;means_acc_ct1(sycl::range&lt;1&gt;(24&nbsp;/*NUM_DIMENSIONS*/),&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1054">1054</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_780">780</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1055">1055</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_781">781</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1056">1056</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rinv_acc_ct1(sycl::range&lt;1&gt;(576&nbsp;/*NUM_DIMENSIONS*NUM_DIMENSIONS*/),</td><td class="diff_next"></td><td class="diff_header" id="to2_782">782</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rinv_acc_ct1(sycl::range&lt;1&gt;(576&nbsp;/*NUM_DIMENSIONS*NUM_DIMENSIONS*/),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1057">1057</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_783">783</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1058">1058</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_784">784</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1059">1059</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td><td class="diff_next"></td><td class="diff_header" id="to2_785">785</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1060">1060</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;NUM_BLOCKS,&nbsp;num_clusters)&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_786">786</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;NUM_BLOCKS,&nbsp;num_clusters)&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1061">1061</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP),</td><td class="diff_next"></td><td class="diff_header" id="to2_787">787</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1062">1062</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP)),</td><td class="diff_next"></td><td class="diff_header" id="to2_788">788</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP)),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1063">1063</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_789">789</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1064">1064</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estep1(d_fcs_data_by_dimension,&nbsp;d_clusters,&nbsp;num_dimensions,</td><td class="diff_next"></td><td class="diff_header" id="to2_790">790</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estep1(d_fcs_data_by_dimension,&nbsp;d_clusters,&nbsp;num_dimensions,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1065">1065</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_events,&nbsp;item_ct1,&nbsp;means_acc_ct1.get_pointer(),</td><td class="diff_next"></td><td class="diff_header" id="to2_791">791</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_events,&nbsp;item_ct1,&nbsp;means_acc_ct1.get_pointer(),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1066">1066</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rinv_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_792">792</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rinv_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1067">1067</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_793">793</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1068">1068</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_794">794</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1069">1069</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_795">795</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.submit([&amp;](sycl::handler&nbsp;&amp;cgh)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1070">1070</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td><td class="diff_next"></td><td class="diff_header" id="to2_796">796</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::accessor&lt;float,&nbsp;1,&nbsp;sycl::access::mode::read_write,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1071">1071</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td><td class="diff_next"></td><td class="diff_header" id="to2_797">797</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::access::target::local&gt;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1072">1072</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_likelihoods_acc_ct1(sycl::range&lt;1&gt;(256&nbsp;/*NUM_THREADS_ESTEP*/),</td><td class="diff_next"></td><td class="diff_header" id="to2_798">798</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_likelihoods_acc_ct1(sycl::range&lt;1&gt;(256&nbsp;/*NUM_THREADS_ESTEP*/),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1073">1073</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td><td class="diff_next"></td><td class="diff_header" id="to2_799">799</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1074">1074</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_800">800</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1075">1075</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td><td class="diff_next"></td><td class="diff_header" id="to2_801">801</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cgh.parallel_for(</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1076">1076</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_BLOCKS)&nbsp;*</td><td class="diff_next"></td><td class="diff_header" id="to2_802">802</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::nd_range&lt;3&gt;(sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_BLOCKS)&nbsp;*</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1077">1077</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP),</td><td class="diff_next"></td><td class="diff_header" id="to2_803">803</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1078">1078</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP)),</td><td class="diff_next"></td><td class="diff_header" id="to2_804">804</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sycl::range&lt;3&gt;(1,&nbsp;1,&nbsp;NUM_THREADS_ESTEP)),</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1079">1079</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_805">805</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[=](sycl::nd_item&lt;3&gt;&nbsp;item_ct1)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1080">1080</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estep2(d_fcs_data_by_dimension,&nbsp;d_clusters,&nbsp;num_dimensions,</td><td class="diff_next"></td><td class="diff_header" id="to2_806">806</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;estep2(d_fcs_data_by_dimension,&nbsp;d_clusters,&nbsp;num_dimensions,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1081">1081</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters,&nbsp;num_events,&nbsp;d_likelihoods,&nbsp;item_ct1,</td><td class="diff_next"></td><td class="diff_header" id="to2_807">807</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters,&nbsp;num_events,&nbsp;d_likelihoods,&nbsp;item_ct1,</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1082">1082</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_likelihoods_acc_ct1.get_pointer());</td><td class="diff_next"></td><td class="diff_header" id="to2_808">808</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;total_likelihoods_acc_ct1.get_pointer());</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1083">1083</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_809">809</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1084">1084</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td><td class="diff_next"></td><td class="diff_header" id="to2_810">810</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1085">1085</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regroup_iterations++;</td><td class="diff_next"></td><td class="diff_header" id="to2_811">811</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;regroup_iterations++;</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__20"></td><td class="diff_header" id="from2_1086">1086</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_812">812</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1087">1087</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check&nbsp;if&nbsp;kernel&nbsp;execution&nbsp;generated&nbsp;an&nbsp;error</td><td class="diff_next"></td><td class="diff_header" id="to2_813">813</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check&nbsp;if&nbsp;kernel&nbsp;execution&nbsp;generated&nbsp;an&nbsp;error</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1088">1088</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//CUT_CHECK_ERROR("Kernel&nbsp;execution&nbsp;failed");</td><td class="diff_next"></td><td class="diff_header" id="to2_814">814</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//CUT_CHECK_ERROR("Kernel&nbsp;execution&nbsp;failed");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1089">1089</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_815">815</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1090">1090</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Copy&nbsp;the&nbsp;likelihood&nbsp;totals&nbsp;from&nbsp;each&nbsp;block,&nbsp;sum&nbsp;them&nbsp;up&nbsp;to&nbsp;get&nbsp;a&nbsp;total</td><td class="diff_next"></td><td class="diff_header" id="to2_816">816</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Copy&nbsp;the&nbsp;likelihood&nbsp;totals&nbsp;from&nbsp;each&nbsp;block,&nbsp;sum&nbsp;them&nbsp;up&nbsp;to&nbsp;get&nbsp;a&nbsp;total</td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__21">n</a></td><td class="diff_header" id="from2_1091">1091</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__21">n</a></td><td class="diff_header" id="to2_817">817</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(shared_likelihoods,&nbsp;d_likelihoods,sizeof(float)&nbsp;*&nbsp;NUM_BLOCKS).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1092">1092</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:76:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1093">1093</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1094">1094</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1095">1095</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1096">1096</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(shared_likelihoods,&nbsp;d_likelihoods,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1097">1097</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;NUM_BLOCKS)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1098">1098</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1099">1099</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1100">1100</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_818">818</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1101">1101</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;=&nbsp;0.0;</td><td class="diff_next"></td><td class="diff_header" id="to2_819">819</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;=&nbsp;0.0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1102">1102</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;i&lt;NUM_BLOCKS;i++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_820">820</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=0;i&lt;NUM_BLOCKS;i++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1103">1103</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;+=&nbsp;shared_likelihoods[i];&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_821">821</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;likelihood&nbsp;+=&nbsp;shared_likelihoods[i];&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1104">1104</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_822">822</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1105">1105</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Likelihood:&nbsp;%e\n",likelihood);</td><td class="diff_next"></td><td class="diff_header" id="to2_823">823</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Likelihood:&nbsp;%e\n",likelihood);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1106">1106</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_824">824</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1107">1107</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;change&nbsp;=&nbsp;likelihood&nbsp;-&nbsp;old_likelihood;</td><td class="diff_next"></td><td class="diff_header" id="to2_825">825</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;change&nbsp;=&nbsp;likelihood&nbsp;-&nbsp;old_likelihood;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1108">1108</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("GPU&nbsp;0:&nbsp;Change&nbsp;in&nbsp;likelihood:&nbsp;%e\n",change);</td><td class="diff_next"></td><td class="diff_header" id="to2_826">826</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("GPU&nbsp;0:&nbsp;Change&nbsp;in&nbsp;likelihood:&nbsp;%e\n",change);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1109">1109</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_827">827</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1110">1110</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iters++;</td><td class="diff_next"></td><td class="diff_header" id="to2_828">828</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iters++;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1111">1111</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_829">829</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1112">1112</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_830">830</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__21"></td><td class="diff_header" id="from2_1113">1113</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("GPU&nbsp;done&nbsp;with&nbsp;EM&nbsp;loop\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_831">831</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("GPU&nbsp;done&nbsp;with&nbsp;EM&nbsp;loop\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1114">1114</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_832">832</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1115">1115</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;copy&nbsp;all&nbsp;of&nbsp;the&nbsp;arrays&nbsp;from&nbsp;the&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_833">833</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;copy&nbsp;all&nbsp;of&nbsp;the&nbsp;arrays&nbsp;from&nbsp;the&nbsp;device</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1116">1116</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;copyClusterFromDevice(&amp;clusters,&nbsp;&amp;temp_clusters,&nbsp;NULL,&nbsp;num_clusters,&nbsp;num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_834">834</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;copyClusterFromDevice(&amp;clusters,&nbsp;&amp;temp_clusters,&nbsp;NULL,&nbsp;num_clusters,&nbsp;num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1117">1117</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_835">835</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__22">n</a></td><td class="diff_header" id="from2_1118">1118</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__22">n</a></td><td class="diff_header" id="to2_836">836</td><td nowrap="nowrap"><span class="diff_add">&nbsp;&nbsp;&nbsp;&nbsp;q_ct1.memcpy(clusters.memberships,&nbsp;temp_clusters.memberships,sizeof(float)&nbsp;*&nbsp;num_events&nbsp;*&nbsp;num_clusters).wait();</span></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1119">1119</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;DPCT1003:77:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1120">1120</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;You&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1121">1121</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1122">1122</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;CUDA_SAFE_CALL((q_ct1</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1123">1123</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.memcpy(clusters.memberships,&nbsp;temp_clusters.memberships,</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1124">1124</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sizeof(float)&nbsp;*&nbsp;num_events&nbsp;*&nbsp;num_clusters)</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1125">1125</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.wait(),</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1126">1126</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0));</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1127">1127</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_837">837</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1128">1128</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("GPU&nbsp;done&nbsp;with&nbsp;copying&nbsp;cluster&nbsp;data&nbsp;from&nbsp;device\n");</td><td class="diff_next"></td><td class="diff_header" id="to2_838">838</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("GPU&nbsp;done&nbsp;with&nbsp;copying&nbsp;cluster&nbsp;data&nbsp;from&nbsp;device\n");</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1129">1129</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_839">839</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1130">1130</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Calculate&nbsp;Rissanen&nbsp;Score</td><td class="diff_next"></td><td class="diff_header" id="to2_840">840</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Calculate&nbsp;Rissanen&nbsp;Score</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1131">1131</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;rissanen&nbsp;=&nbsp;-likelihood&nbsp;+&nbsp;0.5f*(num_clusters*(1.0f+num_dimensions+0.5f*(num_dimensions+1.0f)*num_dimensions)-1.0f)*::logf((float)num_events*num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_841">841</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;rissanen&nbsp;=&nbsp;-likelihood&nbsp;+&nbsp;0.5f*(num_clusters*(1.0f+num_dimensions+0.5f*(num_dimensions+1.0f)*num_dimensions)-1.0f)*::logf((float)num_events*num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1132">1132</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;PRINT("\nLikelihood:&nbsp;%e\n",likelihood);</td><td class="diff_next"></td><td class="diff_header" id="to2_842">842</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;PRINT("\nLikelihood:&nbsp;%e\n",likelihood);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1133">1133</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;PRINT("\nRissanen&nbsp;Score:&nbsp;%e\n",rissanen);</td><td class="diff_next"></td><td class="diff_header" id="to2_843">843</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;PRINT("\nRissanen&nbsp;Score:&nbsp;%e\n",rissanen);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1134">1134</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_844">844</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1135">1135</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Save&nbsp;the&nbsp;cluster&nbsp;data&nbsp;the&nbsp;first&nbsp;time&nbsp;through,&nbsp;so&nbsp;we&nbsp;have&nbsp;a&nbsp;base&nbsp;rissanen&nbsp;score&nbsp;and&nbsp;result</td><td class="diff_next"></td><td class="diff_header" id="to2_845">845</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Save&nbsp;the&nbsp;cluster&nbsp;data&nbsp;the&nbsp;first&nbsp;time&nbsp;through,&nbsp;so&nbsp;we&nbsp;have&nbsp;a&nbsp;base&nbsp;rissanen&nbsp;score&nbsp;and&nbsp;result</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1136">1136</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Save&nbsp;the&nbsp;cluster&nbsp;data&nbsp;if&nbsp;the&nbsp;solution&nbsp;is&nbsp;better&nbsp;and&nbsp;the&nbsp;user&nbsp;didn't&nbsp;specify&nbsp;a&nbsp;desired&nbsp;number</td><td class="diff_next"></td><td class="diff_header" id="to2_846">846</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Save&nbsp;the&nbsp;cluster&nbsp;data&nbsp;if&nbsp;the&nbsp;solution&nbsp;is&nbsp;better&nbsp;and&nbsp;the&nbsp;user&nbsp;didn't&nbsp;specify&nbsp;a&nbsp;desired&nbsp;number</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1137">1137</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;the&nbsp;num_clusters&nbsp;equals&nbsp;the&nbsp;desired&nbsp;number,&nbsp;stop</td><td class="diff_next"></td><td class="diff_header" id="to2_847">847</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;the&nbsp;num_clusters&nbsp;equals&nbsp;the&nbsp;desired&nbsp;number,&nbsp;stop</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1138">1138</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(num_clusters&nbsp;==&nbsp;original_num_clusters&nbsp;||&nbsp;(rissanen&nbsp;&lt;&nbsp;min_rissanen&nbsp;&amp;&amp;&nbsp;desired_num_clusters&nbsp;==&nbsp;0)&nbsp;||&nbsp;(num_clusters&nbsp;==&nbsp;desired_num_clusters))&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_848">848</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(num_clusters&nbsp;==&nbsp;original_num_clusters&nbsp;||&nbsp;(rissanen&nbsp;&lt;&nbsp;min_rissanen&nbsp;&amp;&amp;&nbsp;desired_num_clusters&nbsp;==&nbsp;0)&nbsp;||&nbsp;(num_clusters&nbsp;==&nbsp;desired_num_clusters))&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1139">1139</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_rissanen&nbsp;=&nbsp;rissanen;</td><td class="diff_next"></td><td class="diff_header" id="to2_849">849</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_rissanen&nbsp;=&nbsp;rissanen;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1140">1140</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ideal_num_clusters&nbsp;=&nbsp;num_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_850">850</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ideal_num_clusters&nbsp;=&nbsp;num_clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1141">1141</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;N,clusters.N,sizeof(float)*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_851">851</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;N,clusters.N,sizeof(float)*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1142">1142</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;pi,clusters.pi,sizeof(float)*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_852">852</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;pi,clusters.pi,sizeof(float)*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1143">1143</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;constant,clusters.constant,sizeof(float)*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_853">853</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;constant,clusters.constant,sizeof(float)*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1144">1144</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;avgvar,clusters.avgvar,sizeof(float)*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_854">854</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;avgvar,clusters.avgvar,sizeof(float)*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1145">1145</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;means,clusters.means,sizeof(float)*num_dimensions*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_855">855</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;means,clusters.means,sizeof(float)*num_dimensions*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1146">1146</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;R,clusters.R,sizeof(float)*num_dimensions*num_dimensions*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_856">856</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;R,clusters.R,sizeof(float)*num_dimensions*num_dimensions*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1147">1147</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;Rinv,clusters.Rinv,sizeof(float)*num_dimensions*num_dimensions*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_857">857</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;Rinv,clusters.Rinv,sizeof(float)*num_dimensions*num_dimensions*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1148">1148</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;memberships,clusters.memberships,sizeof(float)*num_events*num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_858">858</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;memcpy(saved_clusters-&gt;memberships,clusters.memberships,sizeof(float)*num_events*num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1149">1149</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_859">859</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1150">1150</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;/****************&nbsp;Reduce&nbsp;GMM&nbsp;Order&nbsp;********************/</td><td class="diff_next"></td><td class="diff_header" id="to2_860">860</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;/****************&nbsp;Reduce&nbsp;GMM&nbsp;Order&nbsp;********************/</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1151">1151</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Don't&nbsp;want&nbsp;to&nbsp;reduce&nbsp;order&nbsp;on&nbsp;the&nbsp;last&nbsp;iteration</td><td class="diff_next"></td><td class="diff_header" id="to2_861">861</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Don't&nbsp;want&nbsp;to&nbsp;reduce&nbsp;order&nbsp;on&nbsp;the&nbsp;last&nbsp;iteration</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1152">1152</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(num_clusters&nbsp;&gt;&nbsp;stop_number)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_862">862</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;if(num_clusters&nbsp;&gt;&nbsp;stop_number)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1153">1153</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//startTimer(timers.cpu);</td><td class="diff_next"></td><td class="diff_header" id="to2_863">863</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//startTimer(timers.cpu);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1154">1154</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_864">864</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1155">1155</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;First&nbsp;eliminate&nbsp;any&nbsp;"empty"&nbsp;clusters&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_865">865</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;First&nbsp;eliminate&nbsp;any&nbsp;"empty"&nbsp;clusters&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1156">1156</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=num_clusters-1;&nbsp;i&nbsp;&gt;=&nbsp;0;&nbsp;i--)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_866">866</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=num_clusters-1;&nbsp;i&nbsp;&gt;=&nbsp;0;&nbsp;i--)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1157">1157</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(clusters.N[i]&nbsp;&lt;&nbsp;0.5)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_867">867</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(clusters.N[i]&nbsp;&lt;&nbsp;0.5)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1158">1158</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Cluster&nbsp;#%d&nbsp;has&nbsp;less&nbsp;than&nbsp;1&nbsp;data&nbsp;point&nbsp;in&nbsp;it.\n",i);</td><td class="diff_next"></td><td class="diff_header" id="to2_868">868</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Cluster&nbsp;#%d&nbsp;has&nbsp;less&nbsp;than&nbsp;1&nbsp;data&nbsp;point&nbsp;in&nbsp;it.\n",i);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1159">1159</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=i;&nbsp;j&nbsp;&lt;&nbsp;num_clusters-1;&nbsp;j++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_869">869</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;j=i;&nbsp;j&nbsp;&lt;&nbsp;num_clusters-1;&nbsp;j++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1160">1160</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy_cluster(clusters,j,clusters,j+1,num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_870">870</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy_cluster(clusters,j,clusters,j+1,num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1161">1161</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_871">871</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1162">1162</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters--;</td><td class="diff_next"></td><td class="diff_header" id="to2_872">872</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;num_clusters--;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1163">1163</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_873">873</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1164">1164</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_874">874</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1165">1165</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_875">875</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1166">1166</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_c1&nbsp;=&nbsp;0;</td><td class="diff_next"></td><td class="diff_header" id="to2_876">876</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_c1&nbsp;=&nbsp;0;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1167">1167</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_c2&nbsp;=&nbsp;1;</td><td class="diff_next"></td><td class="diff_header" id="to2_877">877</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_c2&nbsp;=&nbsp;1;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1168">1168</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Number&nbsp;of&nbsp;non-empty&nbsp;clusters:&nbsp;%d\n",num_clusters);&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_878">878</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEBUG("Number&nbsp;of&nbsp;non-empty&nbsp;clusters:&nbsp;%d\n",num_clusters);&nbsp;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1169">1169</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;For&nbsp;all&nbsp;combinations&nbsp;of&nbsp;subclasses...</td><td class="diff_next"></td><td class="diff_header" id="to2_879">879</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;For&nbsp;all&nbsp;combinations&nbsp;of&nbsp;subclasses...</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1170">1170</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;the&nbsp;number&nbsp;of&nbsp;clusters&nbsp;got&nbsp;really&nbsp;big&nbsp;might&nbsp;need&nbsp;to&nbsp;do&nbsp;a&nbsp;non-exhaustive&nbsp;search</td><td class="diff_next"></td><td class="diff_header" id="to2_880">880</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;If&nbsp;the&nbsp;number&nbsp;of&nbsp;clusters&nbsp;got&nbsp;really&nbsp;big&nbsp;might&nbsp;need&nbsp;to&nbsp;do&nbsp;a&nbsp;non-exhaustive&nbsp;search</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1171">1171</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Even&nbsp;with&nbsp;100*99/2&nbsp;combinations&nbsp;this&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;take&nbsp;too&nbsp;long</td><td class="diff_next"></td><td class="diff_header" id="to2_881">881</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Even&nbsp;with&nbsp;100*99/2&nbsp;combinations&nbsp;this&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;take&nbsp;too&nbsp;long</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1172">1172</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c1=0;&nbsp;c1&lt;num_clusters;c1++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_882">882</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c1=0;&nbsp;c1&lt;num_clusters;c1++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1173">1173</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c2=c1+1;&nbsp;c2&lt;num_clusters;c2++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_883">883</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;c2=c1+1;&nbsp;c2&lt;num_clusters;c2++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1174">1174</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;compute&nbsp;distance&nbsp;function&nbsp;between&nbsp;the&nbsp;2&nbsp;clusters</td><td class="diff_next"></td><td class="diff_header" id="to2_884">884</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;compute&nbsp;distance&nbsp;function&nbsp;between&nbsp;the&nbsp;2&nbsp;clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1175">1175</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance&nbsp;=&nbsp;cluster_distance(clusters,c1,c2,scratch_cluster,num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_885">885</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distance&nbsp;=&nbsp;cluster_distance(clusters,c1,c2,scratch_cluster,num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1176">1176</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_886">886</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1177">1177</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Keep&nbsp;track&nbsp;of&nbsp;minimum&nbsp;distance</td><td class="diff_next"></td><td class="diff_header" id="to2_887">887</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Keep&nbsp;track&nbsp;of&nbsp;minimum&nbsp;distance</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1178">1178</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((c1&nbsp;==0&nbsp;&amp;&amp;&nbsp;c2&nbsp;==&nbsp;1)&nbsp;||&nbsp;distance&nbsp;&lt;&nbsp;min_distance)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_888">888</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if((c1&nbsp;==0&nbsp;&amp;&amp;&nbsp;c2&nbsp;==&nbsp;1)&nbsp;||&nbsp;distance&nbsp;&lt;&nbsp;min_distance)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1179">1179</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_distance&nbsp;=&nbsp;distance;</td><td class="diff_next"></td><td class="diff_header" id="to2_889">889</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_distance&nbsp;=&nbsp;distance;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1180">1180</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_c1&nbsp;=&nbsp;c1;</td><td class="diff_next"></td><td class="diff_header" id="to2_890">890</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_c1&nbsp;=&nbsp;c1;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1181">1181</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_c2&nbsp;=&nbsp;c2;</td><td class="diff_next"></td><td class="diff_header" id="to2_891">891</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;min_c2&nbsp;=&nbsp;c2;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1182">1182</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_892">892</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1183">1183</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_893">893</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1184">1184</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_894">894</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1185">1185</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_895">895</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1186">1186</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRINT("\nMinimum&nbsp;distance&nbsp;between&nbsp;(%d,%d).&nbsp;Combining&nbsp;clusters\n",min_c1,min_c2);</td><td class="diff_next"></td><td class="diff_header" id="to2_896">896</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRINT("\nMinimum&nbsp;distance&nbsp;between&nbsp;(%d,%d).&nbsp;Combining&nbsp;clusters\n",min_c1,min_c2);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1187">1187</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Add&nbsp;the&nbsp;two&nbsp;clusters&nbsp;with&nbsp;min&nbsp;distance&nbsp;together</td><td class="diff_next"></td><td class="diff_header" id="to2_897">897</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Add&nbsp;the&nbsp;two&nbsp;clusters&nbsp;with&nbsp;min&nbsp;distance&nbsp;together</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1188">1188</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_clusters(clusters,min_c1,min_c2,scratch_cluster,num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_898">898</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add_clusters(clusters,min_c1,min_c2,scratch_cluster,num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1189">1189</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_899">899</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1190">1190</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Copy&nbsp;new&nbsp;combined&nbsp;cluster&nbsp;into&nbsp;the&nbsp;main&nbsp;group&nbsp;of&nbsp;clusters,&nbsp;compact&nbsp;them</td><td class="diff_next"></td><td class="diff_header" id="to2_900">900</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Copy&nbsp;new&nbsp;combined&nbsp;cluster&nbsp;into&nbsp;the&nbsp;main&nbsp;group&nbsp;of&nbsp;clusters,&nbsp;compact&nbsp;them</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1191">1191</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy_cluster(clusters,min_c1,scratch_cluster,0,num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_901">901</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy_cluster(clusters,min_c1,scratch_cluster,0,num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1192">1192</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_902">902</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1193">1193</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=min_c2;&nbsp;i&nbsp;&lt;&nbsp;num_clusters-1;&nbsp;i++)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_903">903</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for(int&nbsp;i=min_c2;&nbsp;i&nbsp;&lt;&nbsp;num_clusters-1;&nbsp;i++)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1194">1194</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//printf("Copying&nbsp;cluster&nbsp;%d&nbsp;to&nbsp;cluster&nbsp;%d\n",i+1,i);</td><td class="diff_next"></td><td class="diff_header" id="to2_904">904</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//printf("Copying&nbsp;cluster&nbsp;%d&nbsp;to&nbsp;cluster&nbsp;%d\n",i+1,i);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1195">1195</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy_cluster(clusters,i,clusters,i+1,num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_905">905</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copy_cluster(clusters,i,clusters,i+1,num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1196">1196</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_906">906</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1197">1197</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td><td class="diff_next"></td><td class="diff_header" id="to2_907">907</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1198">1198</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_908">908</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1199">1199</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Copy&nbsp;the&nbsp;clusters&nbsp;back&nbsp;to&nbsp;the&nbsp;device</td><td class="diff_next"></td><td class="diff_header" id="to2_909">909</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Copy&nbsp;the&nbsp;clusters&nbsp;back&nbsp;to&nbsp;the&nbsp;device</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1200">1200</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyClusterToDevice(&amp;clusters,&nbsp;&amp;temp_clusters,&nbsp;num_clusters,&nbsp;num_dimensions);</td><td class="diff_next"></td><td class="diff_header" id="to2_910">910</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;copyClusterToDevice(&amp;clusters,&nbsp;&amp;temp_clusters,&nbsp;num_clusters,&nbsp;num_dimensions);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1201">1201</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_911">911</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1202">1202</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;//&nbsp;GMM&nbsp;reduction&nbsp;block&nbsp;</td><td class="diff_next"></td><td class="diff_header" id="to2_912">912</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;//&nbsp;GMM&nbsp;reduction&nbsp;block&nbsp;</td></tr>
            <tr><td class="diff_next" id="difflib_chg_to2__22"></td><td class="diff_header" id="from2_1203">1203</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;reduce_iterations++;</td><td class="diff_next"></td><td class="diff_header" id="to2_913">913</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;reduce_iterations++;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1204">1204</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_914">914</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1205">1205</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;//&nbsp;outer&nbsp;loop&nbsp;from&nbsp;M&nbsp;to&nbsp;1&nbsp;clusters</td><td class="diff_next"></td><td class="diff_header" id="to2_915">915</td><td nowrap="nowrap">&nbsp;&nbsp;}&nbsp;//&nbsp;outer&nbsp;loop&nbsp;from&nbsp;M&nbsp;to&nbsp;1&nbsp;clusters</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1206">1206</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("\nFinal&nbsp;rissanen&nbsp;Score&nbsp;was:&nbsp;%f,&nbsp;with&nbsp;%d&nbsp;clusters.\n",min_rissanen,ideal_num_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_916">916</td><td nowrap="nowrap">&nbsp;&nbsp;PRINT("\nFinal&nbsp;rissanen&nbsp;Score&nbsp;was:&nbsp;%f,&nbsp;with&nbsp;%d&nbsp;clusters.\n",min_rissanen,ideal_num_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1207">1207</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_917">917</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"><a href="#difflib_chg_to2__top">t</a></td><td class="diff_header" id="from2_1208">1208</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"><a href="#difflib_chg_to2__top">t</a></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1209">1209</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:78:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1210">1210</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1211">1211</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1212">1212</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>sycl::free(d_likelihoods,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_918">918</td><td nowrap="nowrap">&nbsp;&nbsp;sycl::free(d_likelihoods,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1213">1213</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1214">1214</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:79:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1215">1215</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1216">1216</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1217">1217</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>sycl::free(d_fcs_data_by_event,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_919">919</td><td nowrap="nowrap">&nbsp;&nbsp;sycl::free(d_fcs_data_by_event,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1218">1218</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1219">1219</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:80:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1220">1220</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1221">1221</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1222">1222</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>sycl::free(d_fcs_data_by_dimension,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_920">920</td><td nowrap="nowrap">&nbsp;&nbsp;sycl::free(d_fcs_data_by_dimension,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1223">1223</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;/*</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1224">1224</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;DPCT1003:81:&nbsp;Migrated&nbsp;API&nbsp;does&nbsp;not&nbsp;return&nbsp;error&nbsp;code.&nbsp;(*,&nbsp;0)&nbsp;is&nbsp;inserted.&nbsp;You</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1225">1225</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;may&nbsp;need&nbsp;to&nbsp;rewrite&nbsp;this&nbsp;code.</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1226">1226</td><td nowrap="nowrap"><span class="diff_sub">&nbsp;&nbsp;*/</span></td><td class="diff_next"></td><td class="diff_header"></td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1227">1227</td><td nowrap="nowrap">&nbsp;&nbsp;<span class="diff_sub">CUDA_SAFE_CALL((</span>sycl::free(d_clusters,&nbsp;q_ct1)<span class="diff_sub">,&nbsp;0))</span>;</td><td class="diff_next"></td><td class="diff_header" id="to2_921">921</td><td nowrap="nowrap">&nbsp;&nbsp;sycl::free(d_clusters,&nbsp;q_ct1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1228">1228</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_922">922</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1229">1229</td><td nowrap="nowrap">&nbsp;&nbsp;freeCluster(&amp;scratch_cluster);</td><td class="diff_next"></td><td class="diff_header" id="to2_923">923</td><td nowrap="nowrap">&nbsp;&nbsp;freeCluster(&amp;scratch_cluster);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1230">1230</td><td nowrap="nowrap">&nbsp;&nbsp;freeCluster(&amp;clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_924">924</td><td nowrap="nowrap">&nbsp;&nbsp;freeCluster(&amp;clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1231">1231</td><td nowrap="nowrap">&nbsp;&nbsp;freeClusterDevice(&amp;temp_clusters);</td><td class="diff_next"></td><td class="diff_header" id="to2_925">925</td><td nowrap="nowrap">&nbsp;&nbsp;freeClusterDevice(&amp;temp_clusters);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1232">1232</td><td nowrap="nowrap">&nbsp;&nbsp;free(fcs_data_by_dimension);</td><td class="diff_next"></td><td class="diff_header" id="to2_926">926</td><td nowrap="nowrap">&nbsp;&nbsp;free(fcs_data_by_dimension);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1233">1233</td><td nowrap="nowrap">&nbsp;&nbsp;free(shared_likelihoods);</td><td class="diff_next"></td><td class="diff_header" id="to2_927">927</td><td nowrap="nowrap">&nbsp;&nbsp;free(shared_likelihoods);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1234">1234</td><td nowrap="nowrap"></td><td class="diff_next"></td><td class="diff_header" id="to2_928">928</td><td nowrap="nowrap"></td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1235">1235</td><td nowrap="nowrap">&nbsp;&nbsp;*final_num_clusters&nbsp;=&nbsp;ideal_num_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_929">929</td><td nowrap="nowrap">&nbsp;&nbsp;*final_num_clusters&nbsp;=&nbsp;ideal_num_clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1236">1236</td><td nowrap="nowrap">&nbsp;&nbsp;return&nbsp;saved_clusters;</td><td class="diff_next"></td><td class="diff_header" id="to2_930">930</td><td nowrap="nowrap">&nbsp;&nbsp;return&nbsp;saved_clusters;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1237">1237</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_931">931</td><td nowrap="nowrap">}</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1238">1238</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td><td class="diff_next"></td><td class="diff_header" id="to2_932">932</td><td nowrap="nowrap">catch&nbsp;(sycl::exception&nbsp;const&nbsp;&amp;exc)&nbsp;{</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1239">1239</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td><td class="diff_next"></td><td class="diff_header" id="to2_933">933</td><td nowrap="nowrap">&nbsp;&nbsp;std::cerr&nbsp;&lt;&lt;&nbsp;exc.what()&nbsp;&lt;&lt;&nbsp;"Exception&nbsp;caught&nbsp;at&nbsp;file:"&nbsp;&lt;&lt;&nbsp;__FILE__</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1240">1240</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td><td class="diff_next"></td><td class="diff_header" id="to2_934">934</td><td nowrap="nowrap">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&lt;&nbsp;",&nbsp;line:"&nbsp;&lt;&lt;&nbsp;__LINE__&nbsp;&lt;&lt;&nbsp;std::endl;</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1241">1241</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td><td class="diff_next"></td><td class="diff_header" id="to2_935">935</td><td nowrap="nowrap">&nbsp;&nbsp;std::exit(1);</td></tr>
            <tr><td class="diff_next"></td><td class="diff_header" id="from2_1242">1242</td><td nowrap="nowrap">}</td><td class="diff_next"></td><td class="diff_header" id="to2_936">936</td><td nowrap="nowrap">}</td></tr>
        </tbody>
    </table>
    <table class="diff" summary="Legends">
        <tr> <th colspan="2"> Legends </th> </tr>
        <tr> <td> <table border="" summary="Colors">
                      <tr><th> Colors </th> </tr>
                      <tr><td class="diff_add">&nbsp;Added&nbsp;</td></tr>
                      <tr><td class="diff_chg">Changed</td> </tr>
                      <tr><td class="diff_sub">Deleted</td> </tr>
                  </table></td>
             <td> <table border="" summary="Links">
                      <tr><th colspan="2"> Links </th> </tr>
                      <tr><td>(f)irst change</td> </tr>
                      <tr><td>(n)ext change</td> </tr>
                      <tr><td>(t)op</td> </tr>
                  </table></td> </tr>
    </table>
</body>

</html>